/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [HandleInfoMaxTime]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = addinfo | eval info_max_time=if(info_max_time="+Infinity",now() + 315569260,info_max_time)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [ace_event_limit]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = head 10000
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_entity_into_service(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = appendpipe [stats $service_statop$(alert_value) AS alert_value by serviceid, is_entity_in_maintenance | sort 0 serviceid is_entity_in_maintenance | dedup consecutive=t serviceid | eval  is_all_entities_in_maintenance=is_entity_in_maintenance, is_service_aggregate="1", is_entity_defined="0", entity_key="service_aggregate", entity_title="service_aggregate"] | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_entity_into_service_backfill(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = appendpipe [stats $service_statop$(alert_value) AS alert_value, count(entity_key) AS entities_count, count(eval(is_entity_in_maintenance=1)) AS maintenance_entities_count by _time | eval is_service_aggregate="1", is_entity_defined="0", entity_key="service_aggregate", entity_title="service_aggregate", is_all_entities_in_maintenance=if ((entities_count == maintenance_entities_count) AND (entities_count > 0), 1, 0) | fields - entities_count maintenance_entities_count]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_entity_into_service_time_series(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $service_statop$(alert_value) AS alert_value, count(entity_key) AS entities_count, count(eval(is_entity_in_maintenance=1)) AS maintenance_entities_count by _time | eval is_all_entities_in_maintenance=if ((entities_count == maintenance_entities_count) AND (entities_count > 0), 1, 0) | fields - entities_count maintenance_entities_count | timechart bins=500 minspan=$search_alert_earliest$m avg(alert_value) AS alert_value
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_entity_into_service_time_series(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, search_alert_earliest, deep_dive_kpi_statsop
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $service_statop$(alert_value) AS alert_value, count(entity_key) AS entities_count, count(eval(is_entity_in_maintenance=1)) AS maintenance_entities_count by _time | eval is_all_entities_in_maintenance=if ((entities_count == maintenance_entities_count) AND (entities_count > 0), 1, 0) | fields - entities_count maintenance_entities_count | timechart bins=500 minspan=$search_alert_earliest$m $deep_dive_kpi_statsop$(alert_value) AS alert_value
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_and_compare(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, threshold_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | head _time>(info_max_time - $search_alert_earliest$*120) | eval alert_value_window=if(_time<(info_max_time-$search_alert_earliest$*60),"last_window", "current_window") | stats $service_statop$($threshold_field$) AS alert_value by alert_value_window | reverse | delta alert_value AS window_delta | search alert_value_window="current_window" | eval window_direction=if(window_delta >0, "increase", if(window_delta < 0, "decrease", "none")) | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_and_compare(5)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, service_statop, threshold_field, entity_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | head _time>(info_max_time - $search_alert_earliest$*120) | eval alert_value_window=if(_time<(info_max_time-$search_alert_earliest$*60),"last_window", "current_window") | stats $entity_statop$($threshold_field$) AS alert_value by alert_value_window, $entity_field$ | stats $service_statop$(alert_value) AS alert_value by alert_value_window | reverse | delta alert_value AS window_delta | search alert_value_window="current_window" | eval window_direction=if(window_delta >0, "increase", if(window_delta < 0, "decrease", "none")) | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_and_compare_metric(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | sort -_time | head _time>(info_max_time - $search_alert_earliest$*120) | eval alert_value_window=if(_time<(info_max_time-$search_alert_earliest$*60),"last_window", "current_window") | reverse | delta alert_value AS window_delta | search alert_value_window="current_window" | eval window_direction=if(window_delta >0, "increase", if(window_delta < 0, "decrease", "none")) | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_and_compare_metric(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, threshold_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | sort -_time | head _time>(info_max_time - $search_alert_earliest$*120) | eval alert_value_window=if(_time<(info_max_time-$search_alert_earliest$*60),"last_window", "current_window") | stats $service_statop$($threshold_field$) AS alert_value by alert_value_window | reverse | delta alert_value AS window_delta | search alert_value_window="current_window" | eval window_direction=if(window_delta >0, "increase", if(window_delta < 0, "decrease", "none")) | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_entity(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, threshold_field, entity_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $entity_statop$($threshold_field$) AS alert_value by $entity_field$ | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_entity_backfill(5)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, threshold_field, entity_field, alert_period, bucket_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats max(_time) AS maxtime, $entity_statop$($threshold_field$) AS alert_value BY $bucket_field$, $entity_field$ | eval _time=maxtime+$alert_period$*60 |  bucket _time span=$alert_period$m | stats first(*) as * by _time, $entity_field$ | eval _drop=substr($bucket_field$, 0, 2) | search _drop!=-1 | fields - $bucket_field$, maxtime
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_entity_fill_gaps_backfill(5)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, threshold_field, entity_field, alert_period, bucket_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats max(_time) AS maxtime, $entity_statop$($threshold_field$) AS alert_value BY $bucket_field$, $entity_field$ | eval _time=maxtime+$alert_period$*60 |  bucket _time span=$alert_period$m | stats first(*) as * by _time, $entity_field$ | eval _drop=substr($bucket_field$, 0, 2) | search _drop!=-1 | fields - $bucket_field$, maxtime | `fill_gaps_entity_backfill($entity_field$, $alert_period$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_entity_time_series(4)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, threshold_field, entity_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = bucket _time span=$search_alert_earliest$m | stats $entity_statop$($threshold_field$) AS alert_value by _time, $entity_field$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_entity_using_kpi_cache(4)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, threshold_field, entity_field, kpi_key
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $entity_statop$($threshold_field$) AS alert_value by $entity_field$ | `fill_entity_gaps($entity_field$, $kpi_key$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_limited_entity_time_series(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = timechart bins=500 minspan=$search_alert_earliest$m avg(alert_value) AS alert_value by $entity_field$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_limited_entity_time_series(4)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, threshold_field, entity_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = bucket _time span=$search_alert_earliest$m | stats $entity_statop$($threshold_field$) AS alert_value by _time, $entity_field$ | timechart bins=500 minspan=$search_alert_earliest$m avg(alert_value) AS alert_value by $entity_field$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = aggregate_statop, threshold_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $aggregate_statop$($threshold_field$) AS alert_value | eval is_service_aggregate="1", is_entity_defined="0", entity_key="service_aggregate", entity_title="service_aggregate" | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service_backfill(4)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, threshold_field, alert_period, bucket_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats max(_time) AS maxtime, $service_statop$($threshold_field$) AS alert_value BY $bucket_field$ | eval _time=maxtime+$alert_period$*60 |  bucket _time span=$alert_period$m | stats first(*) as * by _time | eval _drop=substr($bucket_field$, 0, 2) | search _drop!=-1 | fields - $bucket_field$, maxtime  | eval is_service_aggregate="1", is_entity_defined="0", entity_key="service_aggregate", entity_title="service_aggregate"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service_fill_gaps_backfill(4)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, threshold_field, alert_period, bucket_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats max(_time) AS maxtime, $service_statop$($threshold_field$) AS alert_value BY $bucket_field$ | eval _time=maxtime+$alert_period$*60 |  bucket _time span=$alert_period$m | stats first(*) as * by _time | eval _drop=substr($bucket_field$, 0, 2) | search _drop!=-1 | fields - $bucket_field$, maxtime | `fill_gaps_aggregate_backfill($alert_period$)` | eval is_service_aggregate="1", is_entity_defined="0", entity_key="service_aggregate", entity_title="service_aggregate"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service_time_series(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = timechart bins=500 minspan=$search_alert_earliest$m avg(alert_value) as alert_value
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service_time_series(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = aggregate_statop, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $aggregate_statop$(_value) AS alert_value by _time | timechart bins=500 minspan=$search_alert_earliest$m avg(alert_value) as alert_value
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service_time_series(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = aggregate_statop, threshold_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = bucket _time span=$search_alert_earliest$m | stats $aggregate_statop$($threshold_field$) AS alert_value by _time | timechart bins=500 minspan=$search_alert_earliest$m avg(alert_value) as alert_value
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service_time_series(4)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = aggregate_statop, threshold_field, search_alert_earliest, deep_dive_kpi_statsop
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = bucket _time span=$search_alert_earliest$m | stats $aggregate_statop$($threshold_field$) AS alert_value by _time | timechart bins=500 minspan=$search_alert_earliest$m $deep_dive_kpi_statsop$(alert_value) as alert_value
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_service_using_kpi_cache(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = aggregate_statop, threshold_field, kpi_key
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $aggregate_statop$($threshold_field$) AS alert_value | `fill_aggregate_gaps($kpi_key$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_single_value(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, threshold_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | head _time>(info_max_time - $search_alert_earliest$*60) | stats $service_statop$($threshold_field$) AS alert_value | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_single_value(5)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_statop, service_statop, threshold_field, entity_field, search_alert_earliest
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | head _time>(info_max_time - $search_alert_earliest$*60) | stats $entity_statop$($threshold_field$) AS alert_value by $entity_field$ | stats $service_statop$(alert_value) AS alert_value | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [aggregate_raw_into_single_value_metric(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_statop, threshold_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = stats $service_statop$($threshold_field$) AS alert_value | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [all_service_health_score_time_series]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `service_health_score_time_series(*)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [apply_entity_lookup(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_lookup_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval sec_grp="default_itsi_security_group" | `match_entities_to_correlation_search($entity_lookup_field$, sec_grp)` | `filter_maintenance_entities`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [apply_model(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,modelname
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_predictive_analytics_dataset($sid$)` | apply $modelname$_ss | apply $modelname$_avg | apply $modelname$_worst
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [assess_severity(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = kpibasesearch
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = setseverityfields kpibasesearch="$kpibasesearch$" | fields - is_all_entities_in_maintenance, entity_keys
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [assess_severity(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = serviceid, kpiid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval maintenance_service_id = "$serviceid$" | `is_object_in_maintenance("service", maintenance_service_id)` | eval is_service_in_maintenance = in_maintenance | fields - in_maintenance, maintenance_service_id | setseverityfields serviceid="$serviceid$", kpiid="$kpiid$" | fields - is_all_entities_in_maintenance
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [assess_severity(5)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = serviceid, kpiid, is_handle_no_data, is_gen_max_severity_event, is_fill_data_gaps
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval maintenance_service_id = "$serviceid$" | `is_object_in_maintenance("service", maintenance_service_id)` | eval is_service_in_maintenance = in_maintenance | fields - in_maintenance, maintenance_service_id | setseverityfields serviceid="$serviceid$", kpiid="$kpiid$" handle_no_data=$is_handle_no_data$ generate_max_severity_event=$is_gen_max_severity_event$ fill_data_gaps=$is_fill_data_gaps$ | fields - is_all_entities_in_maintenance
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [assess_severity(6)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = serviceid, kpiid, is_handle_no_data, is_gen_max_severity_event, is_fill_data_gaps, is_time_series
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval maintenance_service_id = "$serviceid$" | `is_object_in_maintenance("service", maintenance_service_id)` | eval is_service_in_maintenance = in_maintenance | fields - in_maintenance, maintenance_service_id | setseverityfields serviceid="$serviceid$", kpiid="$kpiid$" handle_no_data=$is_handle_no_data$ generate_max_severity_event=$is_gen_max_severity_event$ fill_data_gaps=$is_fill_data_gaps$ is_time_series=$is_time_series$ | fields - is_all_entities_in_maintenance
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [assess_urgency]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval urgency = if (is_service_in_maintenance == 1, 0, urgency)
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [audit_rexsearch]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = rex "search='(?<search>.*?)', autojoin"
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [audit_searchlocal]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = `audit_searchlocal("search_id!=rt_*")`
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [audit_searchlocal(1)]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    args = filter
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = search index=_audit action=search (id=* OR search_id=*) | eval search_id = if(isnull(search_id), id, search_id) | replace '*' with * in search_id | search $filter$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-accesslog-sourcetype(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = resource
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-s3-index` sourcetype="aws:$resource$:accesslogs"
/data/splunk/splunk/etc/apps/Splunk_TA_aws/default/macros.conf             [aws-account-index]
/data/splunk/splunk/etc/apps/Splunk_TA_aws/default/macros.conf             definition = index=summary sourcetype=aws:addon:account source=Splunk_TA_aws
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-account-summary]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = search index=summary sourcetype="aws:addon:account" | dedup host, account_id, name
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-accountid-to-name]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = lookup account_name LinkedAccountId OUTPUT LinkedAccountName | eval LinkedAccountName = if(match(LinkedAccountName, ".*?"), " (".LinkedAccountName.")","") | eval Account=LinkedAccountId.LinkedAccountName
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-anomaly-config]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = rest servicesNS/nobody/splunk_app_aws/configs/conf-anomalyconfigs fillcontents=1 splunk_server=local | rename title as job_id | fillnull value=""
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-anomaly-data]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-anomaly-index`| dedup _time, job_id | eval total = 0 |foreach outlier_* [eval outlier_count_<<MATCHSTR>> = if(<<FIELD>>=="True", 1, 0) ,total = total + outlier_count_<<MATCHSTR>>] | where total > 0
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-anomaly-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = index="summary" sourcetype="aws:anomaly"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-cloudwatch(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, currency
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` source="*:AWS/Billing" metric_dimensions="*Currency=[$currency$]*" | dedup _time metric_dimensions aws_account_id | rex field=metric_dimensions "([ ,]|^)LinkedAccount=\[(?<LinkedAccountId>.*?)\]" | eval LinkedAccountId=if(isnull(LinkedAccountId),aws_account_id,LinkedAccountId) | search $accountId$ | eval zone=strftime(time(),"%z") | eval rel_time=replace(zone, "^([-+]?)0?((?<=0)\d|\d\d)0?((?<=0)\d|\d\d).*$", "\1\2h\1\3m") | eval utctime= _time + 86400 - relative_time(86400, rel_time) | eval currentmonth = strftime(_time,"%m") | eval utcmonth = strftime(utctime,"%m") | where utcmonth=currentmonth
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-datamodel-tags]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = datamodel Detailed_Billing | spath output=fieldName path=objects{}.calculations{}.outputFields{}.fieldName | spath output=displayName path=objects{}.calculations{}.outputFields{}.displayName | table fieldName displayName | eval names=mvzip(fieldName,displayName) | mvexpand names| eval names=split(names,",") | eval fieldName=mvindex(names,0) | eval displayName=mvindex(names,1) | rename displayName as title, fieldName as key | table key, title | search key!="LinkedAccountId"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-datamodel-tags-cur]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = datamodel Detailed_Billing_CUR | spath output=fieldName path=objects{}.calculations{}.outputFields{}.fieldName | spath output=displayName path=objects{}.calculations{}.outputFields{}.displayName | table fieldName displayName | eval names=mvzip(fieldName,displayName) | mvexpand names| eval names=split(names,",") | eval fieldName=mvindex(names,0) | eval displayName=mvindex(names,1) | rename displayName as title, fieldName as key | table key, title | search NOT key IN ("LinkedAccountId", "AssemblyId")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-details(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-sourcetype` eventtype=aws_billing_detail_report $accountId$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-details-cur(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-sourcetype-cur` $accountId$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-index-cur]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-monthly-accounts]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-sourcetype` eventtype=aws_billing_monthly_report (RecordType=AccountTotal OR RecordType=StatementTotal) | eval LinkedAccountId=if(isnull(LinkedAccountId),PayerAccountId,LinkedAccountId) | stats count by LinkedAccountId CurrencyCode
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-monthly-accounts-cur]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = tstats `aws-data-model-acceleration`  count  FROM datamodel=Detailed_Billing_CUR where detailed_billing_cur.invoiceId=*   by detailed_billing_cur.LinkedAccountId , detailed_billing_cur.CurrencyCode   | rename detailed_billing_cur.CurrencyCode as CurrencyCode, detailed_billing_cur.LinkedAccountId as LinkedAccountId | table LinkedAccountId, CurrencyCode, count
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-monthly-item(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, currency, monthSpl
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-sourcetype` $monthSpl$ eventtype=aws_billing_monthly_report CurrencyCode=$currency$ InvoiceID!="Estimated" (RecordType=PayerLineItem OR RecordType=LinkedLineItem) | eval LinkedAccountId=if(isnull(LinkedAccountId),PayerAccountId,LinkedAccountId) | search $accountId$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-monthly-item-cur(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, currency, monthSpl
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-sourcetype-cur` $monthSpl$ CurrencyCode=$currency$ InvoiceId="*" | eval LinkedAccountId=if(isnull(UsageAccountId),PayerAccountId,UsageAccountId) | search $accountId$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-monthly-total(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, currency, monthSpl
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-sourcetype` $monthSpl$ eventtype=aws_billing_monthly_report CurrencyCode=$currency$ (RecordType=AccountTotal OR RecordType=StatementTotal) | eval LinkedAccountId=if(isnull(LinkedAccountId),PayerAccountId,LinkedAccountId) | search $accountId$ | billingtype
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-index` sourcetype="aws:billing"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-sourcetype-cur]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-index-cur` sourcetype="aws:billing:cur"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-billing-sourcetype-cur-digest]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-billing-index-cur` sourcetype="aws:billing:cur:digest"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudtrail(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudtrail-sourcetype` $accountId$ $region$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudtrail-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main" OR `aws-s3-index`)
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudtrail-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudtrail-index` sourcetype="aws:cloudtrail"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region, type
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` eventtype=$type$ $accountId$ $region$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-apigateway(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` $accountId$ $region$ eventtype="aws_cloudwatch_apigateway_events" metric_dimensions!="*],*" metric_dimensions="ApiName=*"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-billing(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, currency
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` source="*:AWS/Billing" metric_dimensions="*Currency=[$currency$]*" metric_dimensions="*],*" 
             | dedup _time metric_dimensions aws_account_id | `aws-cloudwatch-dimension-rex("LinkedAccount", "LinkedAccountId")` 
             | eval LinkedAccountId=if(isnull(LinkedAccountId),aws_account_id,LinkedAccountId) | search $accountId$ 
             | eval zone=strftime(time(),"%z") | eval rel_time=replace(zone, "^([-+]?)0?((?<=0)\d|\d\d)0?((?<=0)\d|\d\d).*$", "\1\2h\1\3m") 
             | eval utctime= _time + 86400 - relative_time(86400, rel_time) | eval currentmonth = strftime(_time,"%m") 
             | eval utcmonth = strftime(utctime,"%m") | where utcmonth=currentmonth
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-dimension-rex(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = dimension, key
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = rex field=metric_dimensions "([ ,]|^)$dimension$=\[(?<$key$>.*?)\]"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-ebs(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` $accountId$ $region$ eventtype="aws_cloudwatch_ebs_events" metric_dimensions!="*],*" metric_dimensions="VolumeId=*"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-ec2(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` $accountId$ $region$ eventtype="aws_cloudwatch_ec2_events" metric_dimensions!="*],*" metric_dimensions="InstanceId=*"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` $accountId$ $region$ eventtype="aws_cloudwatch_elb_events" metric_dimensions!="*],*" metric_dimensions="LoadBalancer*"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-lambda(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` $accountId$ $region$ eventtype="aws_cloudwatch_lambda_events" metric_dimensions!="*],*" metric_dimensions="FunctionName=*"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-logs-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-rds(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` $accountId$ $region$ eventtype="aws_cloudwatch_rds_events" metric_dimensions!="*],*" metric_dimensions="DBInstanceIdentifier=*"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-recommend-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-elb(($accountId$), ($region$))` metric_name="RequestCount" 
             | `aws-cloudwatch-dimension-rex("LoadBalancerName", "name")` 
             | rex field=metric_dimensions "([ ,]|^)LoadBalancer=\[\w*/(?<name>.*?)/" 
             | bucket _time span=1d | stats sum(Sum) as request_count by _time, account_id, region, name 
             | stats max(request_count) as request_count by account_id, region, name
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-s3(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-sourcetype` $accountId$ $region$ eventtype="aws_cloudwatch_s3_events" metric_dimensions="*BucketName=*" metric_dimensions!="*FilterId*"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-cloudwatch-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-index` sourcetype="aws:cloudwatch"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main" OR `aws-s3-index`)
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-notification(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-config-notification-sourcetype` $accountId$ $region$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-notification-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-config-index` sourcetype="aws:config:notification"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-resources(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region, resourceType
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-config-sourcetype` $accountId$  resourceType="$resourceType$" | dedup resourceId sortby -_time | where configurationItemStatus!="ResourceDeleted" | search $region$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-rule(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region, source
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-config-rule-sourcetype` source="*configRule$source$" $accountId$ $region$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-rule-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-rule-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-config-rule-index` sourcetype="aws:config:rule"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-rules-insights(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-config-rule(($accountId$) ,($region$) , ":complianceDetail")` EvaluationResultIdentifier.EvaluationResultQualifier.ConfigRuleName=* ComplianceType="NON_COMPLIANT" | bucket _time span=1d | stats distinct_count(EvaluationResultIdentifier.EvaluationResultQualifier.ResourceId) as count by account_id, region, _time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-config-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-config-index` sourcetype="aws:config"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-data-model-acceleration]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = summariesonly=f
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description(4)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region, resource, dedupfield
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-sourcetype` $accountId$ $region$ source="*:$resource$" | eventstats latest(_time) as latest_time | eval latest_time=relative_time(latest_time,"-55m") | where _time > latest_time | dedup $dedupfield$ sortby -_time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-alb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-elb(($accountId$), ($region$))` | search source="*:application_load_balancers"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-buckets(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-sourcetype` $accountId$ source="*:s3_buckets" | eventstats latest(_time) as latest_time | eval latest_time=relative_time(latest_time,"-55m")  | where _time > latest_time | dedup Name sortby -_time | rename Name as bucket_name
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-clb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-elb(($accountId$), ($region$))` | search (source="*:classic_load_balancers" OR source="*:elastic_load_balancers")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-cloudfront(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-sourcetype` $accountId$ source="*:cloudfront_distributions" | eventstats latest(_time) as latest_time | eval latest_time=relative_time(latest_time,"-55m")  | where _time > latest_time | dedup id sortby -_time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-eip(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-sourcetype` $accountId$ $region$ source="*:ec2_addresses" | eventstats latest(_time) as latest_time | eval latest_time=relative_time(latest_time,"-55m")  | where _time > latest_time | dedup public_ip sortby -_time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-sourcetype` $accountId$ $region$ source="*_load_balancers" 
             | eventstats latest(_time) as latest_time | eval latest_time=relative_time(latest_time,"-55m")  
             | where _time > latest_time 
             | eval name=if(isnull(name), LoadBalancerName, name), vpc_id=if(isnull(vpc_id), VpcId, vpc_id), dns_name=if(isnull(dns_name), DNSName, dns_name) 
             | `aws-resource-uniqId` | dedup uniq_id sortby -_time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-recommend-autoscaling-instance(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-resource(($accountId$), ($region$),"ec2_instances")` | rename tags.aws:autoscaling:groupName as autoscaling_group, id as instance_id | where isnotnull(autoscaling_group) | fields instance_id, state, placement, autoscaling_group
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-recommend-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-elb(($accountId$), ($region$))` | eval availability_zones=if(isnotnull('availability_zones{}'), mvjoin('availability_zones{}', ","),  mvjoin('AvailabilityZones{}.ZoneName', ",")), instances=if(isnotnull('instances{}.state'), mvzip('instances{}.instance_id', 'instances{}.state'), mvzip('TargetGroups{}.TargetHealthDescriptions{}.Target.Id','TargetGroups{}.TargetHealthDescriptions{}.TargetHealth.State')),  healthy_instance_state = mvfilter(match(instances,"\w+,InService$") OR match(instances, "\w+,healthy$")) , healthy_instance_count=if(isnull(healthy_instance_state),0, mvcount(healthy_instance_state)), total_instance_count=if(isnull(instances), 0, mvcount(instances) ) | fields account_id, region, name, instances, availability_zones, healthy_instance_count, total_instance_count, Type
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-recommend-instance(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-resource(($accountId$), ($region$),"ec2_instances")` | rename id as instance_id, tags.Name as instance_name | fields instance_id, instance_name, state, placement
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-resource(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region, resource
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-sourcetype` $accountId$ $region$ source="*:$resource$" | eventstats latest(_time) as latest_time | eval latest_time=relative_time(latest_time,"-55m") | where _time > latest_time | dedup id sortby -_time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-description-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-index` sourcetype="aws:description"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-ec2-description]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = where state="running" | rename placement as availability_zone, placement_tenancy as tenancy, image.attributes.location as location | fields _time, aws_account_id, id, spot_instance_request_id, region, availability_zone, location, platform, tenancy, instance_type | extractplatform | bucket _time span=1h | stats dc(id) as count dc(spot_instance_request_id) as spot by _time, aws_account_id, region, platform, tenancy, instance_type, availability_zone | eval spot=spot-1, count=count-spot
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-ec2-info]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = eval family=split(instance_type,"."), family=mvindex(family,0), run_instance_info=_time.",".availability_zone.",".instance_type.",".count
/data/splunk/splunk/etc/apps/Splunk_TA_aws/default/macros.conf             [aws-input-index]
/data/splunk/splunk/etc/apps/Splunk_TA_aws/default/macros.conf             definition = index=summary sourcetype=aws:addon:input source=Splunk_TA_aws
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-input-summary]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = search index=summary sourcetype="aws:addon:input" | dedup host, input_name
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-insecure-listener-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-elb(($accountId$), ($region$))` | eval listener_protocols=if(isnotnull('listeners{}.protocol'), mvjoin('listeners{}.protocol',","), mvjoin('Listeners{}.Protocol', ",")), contain_secure_protocol=if(like(listener_protocols, "%HTTPS%") OR like(listener_protocols, "%SSL%"), 1, 0), insight="Insecure listener protocol" | where contain_secure_protocol = 0 | eval availability_zones=if(isnotnull('availability_zones{}'), mvjoin('availability_zones{}', ","),  mvjoin('AvailabilityZones{}.ZoneName', ",")) | fields account_id, region, name, insight, availability_zones, Type
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-insights-combination(3)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region, earliest
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = index=summary insights=* $accountId$ | eval region=if(insights="iam", "Global", region), insights=case(insights="iam", "IAM", insights="eip", "Elastic IP", insights="sg", "Security Group", insights="elb", "ELB", insights="ec2", "EC2", insights="ebs", "EBS")
            | search $region$ | bucket _time span=1d | stats sum(count) as count by account_id, region, insights, _time 
            | append [search earliest=$earliest$ `aws-config-rules-insights(($accountId$) ,($region$))` | eval insights="Config Rules" ] 
            | append [search earliest=$earliest$ `aws-inspector-insights(($accountId$) ,($region$))` | eval insights="Amazon Inspector" ] 
            | append [search earliest=$earliest$ `aws-personal-health-insights(($accountId$) ,($region$))` | eval insights="AWS Personal Health"]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-inspector-findings]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-inspector-sourcetype` source="*:inspector:finding"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-inspector-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-inspector-insights(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-inspector-findings` `aws-inspector-rex-arn` | search $accountId$ $region$ | bucket _time span=1d | stats distinct_count(arn) as count by account_id, region, _time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-inspector-rex-arn]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = | rex field=arn "^arn:.+?:inspector:(?<region>[^:]+):(?<accountId>[^:]+):target/(?<target>[^/]+)/template/(?<template>[^/]+)(/|$)"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-inspector-runs]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-inspector-sourcetype` source="*:inspector:assessmentRun"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-inspector-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-inspector-index` sourcetype="aws:inspector"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-key-rotation-iam(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description(($accountId$), ("*"), "iam_users", "Arn")` | spath output=AccessKeys path=AccessKeys{} | eval AccessKeys=mvfilter(match(AccessKeys,".*\"Status\": \"Active\",*")) | fields account_id UserName AccessKeys | mvexpand AccessKeys | rex field=AccessKeys ".*CreateDate\": \"(?<CreateDate>[^\"]*)" | eval CreateDay=strptime(CreateDate, "%FT%T"), diff_days=(now()-CreateDay)/86400 | where diff_days > 90 |fields account_id UserName CreateDate | mvcombine CreateDate | eval insight="IAM access key rotation"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-large-number-rules-sg(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-resource(($accountId$), ($region$), "ec2_security_groups")` | spath output=inbound path=rules{}.grants{} | spath output=outbound path=rules_egress{}.grants{} | eval inbound_count=mvcount(inbound), outbound_count=mvcount(outbound), total_count = inbound_count+outbound_count | where (isnotnull(vpc_id) AND total_count > 50) OR (isnull(vpc_id) AND total_count > 100) | eval insight="Large number of rules"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-long-unused-iam(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description(($accountId$), ("*"), "iam_users", "Arn")` | spath output=AccessKeys path=AccessKeys{} | eval AccessKeys=mvfilter(match(AccessKeys,".*\"Status\": \"Active\",*")) | fields account_id UserName AccessKeys PasswordLastUsed | mvexpand AccessKeys | rex field=AccessKeys ".*LastUsedDate\": \"(?<LastUsedDate>[^\"]*)" | eval ak_used_day=strptime(LastUsedDate, "%FT%T"), ps_used_day=strptime(PasswordLastUsed, "%FT%T"), recent_used_day=max(ak_used_day,ps_used_day), diff_days=(now()-recent_used_day)/86400 | stats min(diff_days) as no_used_days by UserName, account_id | where no_used_days > 30 | eval insight="User is unused for long time"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-not-autoscaling-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-recommend-elb(($accountId$), ($region$))` | where healthy_instance_count = 1 | mvexpand instances | rex field=instances "(?<instance_id>[^,]+),(?<instance_elb_state>[^,]+)" | search (instance_elb_state="InService" OR instance_elb_state="healthy") | join type=left instance_id [search earliest=-1d `aws-description-recommend-autoscaling-instance(($accountId$), ($region$))`] | where isnull(autoscaling_group) | eval insight="One healthy instance without autoscaling"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-not-cross-zone-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-recommend-elb(($accountId$), ($region$))` | where healthy_instance_count>=1 | mvexpand instances | rex field=instances "(?<instance_id>[^,]+),(?<instance_elb_state>[^,]+)" | search (instance_elb_state="InService" OR instance_elb_state="healthy") | join type=left instance_id [search earliest=-1d `aws-description-recommend-instance(($accountId$),($region$))`] | stats count(placement) as healthy_AZ_count, values(Type) as Type, values(placement) as placement by account_id, region, name, availability_zones | search healthy_AZ_count = 1 | eval insight="Healthy instances are not cross-zone"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-not-enough-request-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-recommend-elb(($accountId$), ($region$))` | join type=left account_id, region, name [search earliest=-7d `aws-cloudwatch-recommend-elb(($accountId$), ($region$))`] | where isnotnull(request_count) AND request_count<200 | eval insight="Not enough requests"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-password-policy-iam(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description(($accountId$), ("*"), "iam_users", "Arn")` | dedup account_id | rename PasswordPolicy.AllowUsersToChangePassword as policy, PasswordPolicy.PasswordReusePrevention as reuse  | where isnull(policy) OR isnull(reuse) | eval insight=if(isnull(policy), "No password policy", "Password reuse is not prevented"), UserName="Root Account"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-personal-health-insights(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-sqs-sourcetype` AND BodyJson.source="aws.health" AND BodyJson.detail.eventTypeCategory="issue" | rename  BodyJson.time as time, BodyJson.account as account_id, BodyJson.region as region | search $accountId$ $region$ | eval _time = strptime(time, "%Y-%m-%dT%H:%M:%S")| bucket _time span=1d | stats count by account_id, region, _time
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-redundant-sg(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-resource(($accountId$), ($region$), "ec2_security_groups")` | spath output=inbound path=rules{} | spath output=outbound path=rules_egress{} | rename inbound as rules | `aws-redundant-sg-helper` | stats values(parameter) as inbound, values(outbound) as rules by account_id, id, region, vpc_id | `aws-redundant-sg-helper` | stats values(parameter) as outbound, values(inbound) as inbound by account_id, id, region, vpc_id | eval inbound=mvsort(inbound), outbound=mvsort(outbound) | fields account_id, id, region, inbound, outbound, vpc_id | mvcombine id | eval id_count=mvcount(id), same_ids=id, id=mvindex(id,0)  | where id_count > 1 | eval insight="Redundant security groups"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-redundant-sg-helper]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = mvexpand rules | rex field=rules ".*\[{(?<grants>[^\]]+).*" | eval grants_len=len(grants), grants=substr(grants,1,grants_len-2), grants=split(grants, "}, {"), grants=mvsort(grants), grants=mvjoin(grants, ","), parameter=replace(rules, ", \"grants\".*]", "") + grants
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-resource-uniqId]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = eval uniq_id = name."#".account_id."#".region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-resource-uniqLabel]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = lookup regions region | eval uniq_label = name." (".account_id.", ".location.")"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-ri-info]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = search state=active | rename instance_tenancy as tenancy, description as platform | stats sum(instance_count) as RI_count by aws_account_id, region, availability_zone, platform, tenancy, instance_type | eval family=split(instance_type,"."), family=mvindex(family,0), RI_info = availability_zone.",".instance_type.",".RI_count | stats values(RI_info) as RI_info by aws_account_id, region, platform, tenancy, family
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-s3-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-sourcetype-index-summary]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = search index=summary sourcetype="aws:addon:input" earliest=-1d | dedup input_sourcetype, input_index | table input_sourcetype, input_index
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-specific-ports-unrestricted-sg(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-resource(($accountId$), ($region$), "ec2_security_groups")` | spath output=inbound path=rules{} | mvexpand inbound | regex inbound=".*cidr_ip\": \"0.0.0.0/0.*" | rex field=inbound ".*to_port\": [\"]*(?<to_port>[^\",}]*).*" |rex field=inbound ".*from_port\": [\"]*(?<from_port>[^\",}]*).*" | fields account_id, region, id, vpc_id, to_port, from_port | where [| inputlookup sg_ports | search risk="high" | eval searchstr="from_port<=".port." AND to_port>=".port | return 100 $searchstr]  | eval insight="Unrestricted access on specific ports", port=if(from_port=to_port, from_port, from_port." - ".to_port) | fields - to_port, from_port | mvcombine port
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-sqs-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = (index="main")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-sqs-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-sqs-index` sourcetype="aws:sqs"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-unrestricted-access-sg(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-resource(($accountId$), ($region$), "ec2_security_groups")` | spath output=inbound path=rules{} | mvexpand inbound | regex inbound=".*cidr_ip\": \"0.0.0.0/0.*" | rex field=inbound ".*to_port\": [\"]*(?<to_port>[^\",}]*).*" |rex field=inbound ".*from_port\": [\"]*(?<from_port>[^\",}]*).*" | fields account_id, region, id, vpc_id, to_port, from_port | where NOT ( [| inputlookup sg_ports | eval searchstr="from_port=".port." AND to_port=".port | return 100 $searchstr] ) | eval insight="Unrestricted access", port=if(from_port=to_port, from_port, from_port." ~ ".to_port) | fields - to_port, from_port | mvcombine port
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-unused-eip(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description(($accountId$), ($region$), "ec2_addresses", "public_ip")` | join type=left instance_id [search earliest=-1d `aws-description-resource(($accountId$), ($region$), "ec2_instances")` | rename id as instance_id, tags.Name as name | fields instance_id name state] | eval insight = case(instance_id=="null" AND network_interface_id=="null","No attached instance", state!="running", "Inactive attached instance")
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-unused-elb(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-recommend-elb(($accountId$), ($region$))` | where total_instance_count >= 0 AND healthy_instance_count = 0 | eval insight="No healthy instance"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-unused-sg(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, region
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-description-resource(($accountId$), ($region$), "ec2_security_groups")` | spath output=instances path=instances{}.id | eval instances_count=mvcount(instances) | where isnull(instances_count) | eval insight="Unused security group" | fields account_id, region, name, id, vpc_id, insight
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-vpc-flow(4)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = accountId, interfaces, protocol, vpcflow_action
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-vpc-flow-sourcetype` $accountId$ $interfaces$ vpcflow_action=$vpcflow_action$ protocol=$protocol$
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-vpc-flow-log-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = index="aws_vpc_flow_logs"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [aws-vpc-flow-sourcetype]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = `aws-cloudwatch-logs-index` sourcetype="aws:cloudwatchlogs:vpcflow"
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [boxplot]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = untable _x field_name value
| stats min exactperc25 median exactperc75 max by field_name
| untable field_name calculations value
| xyseries calculations field_name value
| eval calculations = rtrim(calculations, "(value)")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [classificationreport(2)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = a, p
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = rename "$a$" as actual, "$p$" as predicted
| stats count by actual predicted
| xyseries actual predicted count
| fillnull
| untable actual predicted count
| stats sum(eval(if(actual == predicted, count, 0))) as t sum(eval(if(actual != predicted, count, 0))) as f by actual predicted
| eventstats sum(eval(if(actual==predicted, t, 0))) as tp sum(eval(if(actual!=predicted, f, 0))) as fn by actual
| eventstats sum(eval(if(actual!=predicted, f, 0))) as fp by predicted
| eval count=if(actual==predicted,t,f), fp=if(actual==predicted, fp, 0), fn=if(actual==predicted, fn,0), tp=if(actual==predicted, tp, 0)
| stats sum(count) as count sum(t) as t sum(f) as f sum(tp) as tp sum(fn) as fn sum(fp) as fp by actual
| eventstats sum(count) as total
| eval precision=tp/(tp+fp)
| eval recall=tp/(tp+fn)
| eval f1=2*precision*recall/(precision+recall)
| eval accuracy=t/count
| fillnull
| appendpipe [ stats sum(count) as count sum(eval(accuracy*count/total)) as accuracy sum(eval(precision*count/total)) as precision sum(eval(recall*count/total)) as recall sum(eval(f1*count/total)) as f1 | eval actual="Weighted Average" ]
| rename actual as class
| table class accuracy precision recall f1 count
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         iseval = 0
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [classificationstatistics(2)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = a, p
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = `classificationreport("$a$", "$p$")`
| tail 1
| eval precision=round(precision, 2), recall=round(recall, 2), accuracy=round(accuracy, 2), f1=round(f1, 2)
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         iseval = 0
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [cloudtrail_service(2)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = service, notable
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = lookup all_eventName eventName OUTPUT function | fillnull value="N/A" function | search function="$service$" | eval notable=if(match(eventName, "(^Get*|^List*|^Describe*)"), 0, 1) | search notable=$notable$
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [comment(1)]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    args = text
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = ""
/data/splunk/splunk/etc/apps/search/default/macros.conf                    iseval = 1
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [composite_health_data]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` source=service_health_monitor scoretype="compositekpi_health"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [composite_kpi_meta_data]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval gs_search_source="KPI Correlation" | eval time=strftime(_time, " %Y-%m-%d %H:%M:%S.%3N %p") | eval event_description='composite_kpi_name' + " status was " + 'severity_label' + " (Health Score=" + 'health_score' + ") at " + time
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [confusionmatrix(2)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = a, p
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = rename "$a$" as actual, "$p$" as predicted
| stats count by actual predicted
| appendpipe [ eval predicted=actual, count=0 ]
| stats sum(count) as count by actual predicted
| xyseries actual predicted count
| rename * as "Predicted *"
| rename "Predicted $a$" as "Actual $a$"
| fillnull value=0
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         iseval = 0
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf [convert_k8s_resource_to_megabytes(1)]
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf args = field_name
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf definition = eval $field_name$=case( 
  like($field_name$, "%Ei"), 
    tonumber(replace($field_name$, "Ei", "")) * pow(1024, 6) / pow(1000, 2),  
  like($field_name$, "%Pi"), 
    tonumber(replace($field_name$, "Pi", "")) * pow(1024, 5) / pow(1000, 2),  
  like($field_name$, "%Ti"), 
    tonumber(replace($field_name$, "Ti", "")) * pow(1024, 4) / pow(1000, 2),  
  like($field_name$, "%Gi"), 
    tonumber(replace($field_name$, "Gi", "")) * pow(1024, 3) / pow(1000, 2),  
  like($field_name$, "%Mi"), 
    tonumber(replace($field_name$, "Mi", "")) * pow(1024, 2) / pow(1000, 2), 
  like($field_name$, "%Ki"), 
    tonumber(replace($field_name$, "Ki", "")) * 1024 / 1000, 
  like($field_name$, "%E"), 
    tonumber(replace($field_name$, "E", "")) * pow(1000, 4),  
  like($field_name$, "%P"), 
    tonumber(replace($field_name$, "P", "")) * pow(1000, 3),  
  like($field_name$, "%T"), 
    tonumber(replace($field_name$, "T", "")) * pow(1000, 2),  
  like($field_name$, "%G"), 
    tonumber(replace($field_name$, "G", "")) * pow(1000, 1),  
  like($field_name$, "%M"), 
    tonumber(replace($field_name$, "M", "")), 
  like($field_name$, "%K"), 
    tonumber(replace($field_name$, "K", "")) / 1000 
)
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf description = A macro command to convert k8s resource values (contained in k8s metadata) to a consistent megabytes
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [decorate_aggregate_fields]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval is_service_aggregate="1", is_entity_defined="0", entity_key="service_aggregate", entity_title="service_aggregate" | `gettime`
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              [dga_apply_features]
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              definition = | apply "dga_ngram"
| apply "dga_pca"
| fields - domain_tfidf* 
| `ut_shannon(domain)` 
| `ut_meaning(domain)` 
| eval ut_digit_ratio = 0.0 
| eval ut_vowel_ratio = 0.0 
| eval ut_domain_length = max(1,len(domain)) 
| rex field=domain max_match=0 "(?<digits>\d)" 
| rex field=domain max_match=0 "(?<vowels>[aeiou])" 
| eval ut_digit_ratio=if(isnull(digits),0.0,mvcount(digits) / ut_domain_length) 
| eval ut_vowel_ratio=if(isnull(vowels),0.0,mvcount(vowels) / ut_domain_length) 
| eval ut_consonant_ratio = max(0.0, 1.000000 - ut_digit_ratio - ut_vowel_ratio) 
| fields - digits - vowels
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              [dga_create_full_features(2)]
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              args = in,out
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              definition = inputlookup $in$ `dga_apply_features` | sample partitions=2 | outputlookup $out$ | stats count | eval setup_action="events processed and written to lookup \"$out$\""
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              [dga_create_ngram_model(2)]
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              args = in,out
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              definition = inputlookup $in$ | `dga_create_tfidf_pca_model` | stats count | eval setup_action="events processed into models \"dga_ngram\" and \"dga_pca\" to generate ngram based text features" | eval ignored="\"$out$\""
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              [dga_create_tfidf_pca_model]
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              definition = fit TFIDF domain analyzer=char ngram_range=2-3 into "dga_ngram"
| fit PCA domain_tfidf* k=3 into "dga_pca"
| fields - domain_tfidf*
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              [dga_create_validation(2)]
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              args = in,out
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              definition = inputlookup $in$ | apply "dga_randomforest" | chart count over subclass by "predicted(class)" | eval ratio=dga/(dga+legit+1) | sort ratio | outputlookup $out$
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_audit_get_search_type]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval search_type = case( 
match(search_id, "^SummaryDirector_"), "summarization", 
match(search_id, "^((rt_)?scheduler__|alertsmanager_)"), "scheduled", 
match(search_id, "\d{10}\.\d+(_[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})?$"), "ad hoc", 
true(), "other")
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_audit_get_searches(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_audit` host=$host$ action=search sourcetype=audittrail search_id!="rsa_*" 
| eval user = if(user="n/a", null(), user) 
| `dmc_audit_get_search_type` 
| eval search=if(isnull(savedsearch_name) OR savedsearch_name=="", search, savedsearch_name)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_audit_get_searches_for_groups(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = search_group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_audit` search_group=dmc_group_search_head search_group=$search_group$ action=search sourcetype=audittrail search_id!="rsa_*" 
| eval user = if(user="n/a", null(), user) 
| `dmc_audit_get_search_type` 
| eval search=if(isnull(savedsearch_name) OR savedsearch_name=="", search, savedsearch_name)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_audit_searchlocal(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = filter
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = search `dmc_set_index_audit` action=search (id=* OR search_id=*) | eval search_id = if(isnull(search_id), id, search_id) | replace '*' with * in search_id | search $filter$
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_background_flush_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=percent "0-10%"=0-10 "10-50%"=10.001-50 "50-100%"=50.001-100 default=abnormal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_build_forwarder_assets(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = sparkline_span
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_get_forwarder_tcpin` 
| stats values(fwdType) as forwarder_type, latest(version) as version, values(arch) as arch, values(os) as os, max(_time) as last_connected, sum(kb) as new_sum_kb, sparkline(avg(tcp_KBps), $sparkline_span$) as new_avg_tcp_kbps_sparkline, avg(tcp_KBps) as new_avg_tcp_kbps, avg(tcp_eps) as new_avg_tcp_eps by guid, hostname
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_classify_processes]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval process_class = case(    
    process=="splunk-optimize","index service",    
    process=="sh" OR process=="ksh" OR process=="bash" OR like(process,"python%") OR process=="powershell","scripted input",    
    process=="mongod", "KVStore") 
| eval process_class = case(    
    process=="splunkd" AND (like(args,"-p %start%") OR like(args,"service") OR like(args,"%_internal_launch_under_systemd%")),"splunkd server",    
    process=="splunkd" AND isnotnull(sid),"search",    
    process=="splunkd" AND (like(args,"fsck%") OR like(args,"recover-metadata%") OR like(args,"cluster_thing")),"index service",    
    process=="splunkd" AND args=="instrument-resource-usage", "scripted input",
    (like(process,"python%") AND like(args,"%/appserver/mrsparkle/root.py%")) OR like(process,"splunkweb"),"Splunk Web",    
    isnotnull(process_class), process_class)    
| eval process_class = if(isnull(process_class),"other",process_class)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_collection_interval]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = collection_interval = 10
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_convert_count_unit(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = x
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = case( 
$x$ >= 1000000000000, round($x$ / 1000000000000, 2)."T", 
$x$ >= 1000000000, round($x$ / 1000000000, 2)."B", 
$x$ >= 1000000, round($x$ / 1000000, 2)."M", 
$x$ >= 1000, round($x$ / 1000, 2)."K", 
true(), $x$ 
)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_convert_disk_usage_unit(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = x
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = case( 
$x$ > 1000000, round($x$ / 1024 / 1024, 2)." TB" 
$x$ > 1000, round($x$ / 1024, 2)." GB" 
1 == 1, $x$." MB" 
)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_convert_runtime(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = runtime
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = case( 
round($runtime$ / (3600*24) - 0.5) > 0, round($runtime$ / (3600*24) - 0.5)."d ".round(($runtime$ % (3600*24)) / 3600 - 0.5)."h ".round(($runtime$ % 3600) / 60 - 0.5)."min ".round($runtime$ % 60, 2)."s", 
round(($runtime$ % (3600*24)) / 3600 - 0.5) > 0, round(($runtime$ % (3600*24)) / 3600 - 0.5)."h ".round(($runtime$ % 3600) / 60 - 0.5)."min ".round($runtime$ % 60, 2)."s", 
round(($runtime$ % 3600) / 60 - 0.5) > 0, round(($runtime$ % 3600) / 60 - 0.5)."min ".round($runtime$ % 60, 2)."s", 
1 = 1, round($runtime$ % 60, 2)."s" 
)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_cpu_usage_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=cpu_usage "0-60%"=0-60 "60-80%"=60.001-80 "80-100%"=80.001-100 "100%+"=100.001-999999 default=abnormal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_cpu_usage_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_cpu_usage_rangemap` 
| `dmc_timechart` partial=f dc(server) as server_count by range 
| fields _time, "100%+", "80-100%", "60-80%", "0-60%"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_daily_license_usage_quota]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rest `dmc_dmc_group_license_master` /services/licenser/pools 
| join type=outer stack_id splunk_server [rest `dmc_dmc_group_license_master` /services/licenser/groups | search is_active=1 | eval stack_id=stack_ids | fields splunk_server stack_id is_active] 
| search is_active=1 
| fields splunk_server, stack_id, used_bytes 
| join type=outer stack_id splunk_server [rest `dmc_dmc_group_license_master` /services/licenser/stacks | eval stack_id=title | eval stack_quota=quota | fields splunk_server stack_id stack_quota] 
| stats sum(used_bytes) as used_bytes max(stack_quota) as stack_quota by splunk_server 
| eval usedGB=round(used_bytes/1024/1024/1024,3) 
| eval totalGB=round(stack_quota/1024/1024/1024,3) 
| eval percentage=round(usedGB / totalGB, 3)*100 
| fields splunk_server, percentage, usedGB, totalGB
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_disk_usage_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=pct_disk_usage "0-60%"=0-0.6 "60-80%"=0.6001-0.8 "80-100%"=0.8001-1 default=abnormal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_disk_usage_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_disk_usage_rangemap` 
| `dmc_timechart_for_disk_usage` partial=f dc(server_mount_point) as server_mount_point_count by range 
| fields _time, "80-100%", "60-80%", "0-60%"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_dmc_group_license_master]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = splunk_server_group=dmc_group_license_master
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_indexing_performance_deployment_indexing_rate(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_internal` source=*metrics.log* sourcetype=splunkd search_group=dmc_group_indexer search_group=$group$ group=thruput name=index_thruput 
| stats sum(kb) AS total_kb by host 
| addinfo 
| eval time_window = info_max_time - info_min_time 
| eval kbps = round(total_kb / time_window, 0) 
| `dmc_indexing_rate_rangemap` 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." dmc_group_indexer" 
| fields serverName, machine, kbps, range, numberOfCores, ram, version, Action
| eval kbps = kbps." KB/s" 
| rename serverName as Instance, machine as Machine, kbps as "Indexing Rate", range as "Indexing Rate Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_indexing_performance_deployment_queue_fill_ratio(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group, queueType, funcQueue, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_internal` source=*metrics.log sourcetype=splunkd search_group=dmc_group_indexer search_group=$group$ group=queue name=$queueType$ 
| eval max=if(isnotnull(max_size_kb),max_size_kb,max_size) 
| eval curr=if(isnotnull(current_size_kb),current_size_kb,current_size) 
| eval fill_perc=round((curr/max)*100,2) 
| stats $funcQueue$(fill_perc) AS fill_percentage by host 
| `dmc_queue_fill_ratio_rangemap` 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." dmc_group_indexer" 
| fields serverName, machine, fill_percentage, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, fill_percentage as "Fill Ratio (%)", range as "Fill Ratio Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_join_peers_by_peerURI]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = lookup dmc_assets host OUTPUT peerURI, serverName, machine 
| eval peerURI = mvindex(peerURI, 0) 
| eval machine = mvindex(machine, 0) 
| eval serverName = mvindex(serverName, 0) 
| join type=outer peerURI 
 [| rest splunk_server=local /services/search/distributed/peers 
  | rename title as peerURI 
  | append  
    [| rest splunk_server=local /services/server/info 
     | eval peerURI = "localhost" 
    ] 
  | eval ram = round(physicalMemoryMB / 1024, 2)." GB" 
  | fields peerURI, version, numberOfCores, ram 
 ] 
| eval Action = serverName 
| fields - _time
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_kv_store_deployment_background_flush(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstoreserverstats 
| stats range(data.backgroundFlushing.total_ms)  AS diff by  host 
| addinfo 
| eval time_window = info_max_time - info_min_time 
| eval ms_per_min = diff / (time_window / 60) 
| eval percent = round(ms_per_min / (60 * 1000) * 100, 2) 
| `dmc_background_flush_rangemap` 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." dmc_group_kv_store" 
| fields serverName, machine, percent, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, percent as "Background Flush (%)", range as "Background Flush Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_kv_store_deployment_lock_percentage(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group, countLockFunc, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=dmc_group_kv_store  search_group=$group$ component=kvstoreserverstats 
| stats range(data.globalLock.lockTime) AS globalLock range(data.globalLock.totalTime) AS total by host  
| eval percent=abs(globalLock*100/total)   
| stats $countLockFunc$(percent) as percent_locked by host 
| rangemap field=percent_locked "0-30%"=0-30 "30-50%"=30.001-50 "50-100%"=50.001-1000 default=abnormal  
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." dmc_group_kv_store" 
| fields serverName, machine, percent_locked, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, percent_locked as "Lock (%)", range as "Lock Percentage Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_kv_store_deployment_memory_ratio(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstoreserverstats 
| eval ratio='data.mem.virtual'/'data.mem.mappedWithJournal' 
| stats avg(ratio) AS myratio by host  
| eval myratio = round(myratio, 2) 
| rangemap field=myratio "0-2x"=0-2 "2-3x"=2.001-3 ">3x"=3.001-10000 default=abnormal 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." dmc_group_kv_store" 
| fields serverName, machine, myratio, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, myratio as "Virtual to Mapped Ratio", range as "Ratio Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_kv_store_deployment_network(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=dmc_group_kv_store search_group=$group$ component=kvstoreserverstats 
| stats range(data.network.bytesIn) as indiff range(data.network.bytesOut) as outdiff range(data.network.numRequests) as Requests by host 
| eval "MB In"=indiff/1000000 
| eval "MB Out"=outdiff/1000000 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." dmc_group_kv_store" 
| table serverName, machine, "MB In", "MB Out", Requests, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_kv_store_deployment_page_faults(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group, countPageFaultsFunc, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=dmc_group_kv_store search_group=$group$ component=kvstoreserverstats  
| rename data.opcounters.command as c, data.opcounters.update as u, data.opcounters.queries as q, data.opcountes.deletes as d, data.opcounters.getmore as g, data.opcounters.inserts as i 
| eval commands=if(isNotNull('c'), 'c',0) 
| eval updates=if(isNotNull('u'), 'u', 0) 
| eval queries=if(isNotNull('q'), 'q', 0) 
| eval deletes=if(isNotNull('d'), 'd', 0) 
| eval getmores=if(isNotNull('g'), 'g', 0) 
| eval inserts=if(isNotNull('i'), 'i', 0) 
| eval totalops=commands+updates+queries+deletes+getmores+inserts 
| bin _time minspan=30s 
| stats latest(totalops) AS ops latest(data.extra_info.page_faults) AS pf by host _time 
| eval  percent=if(opsdiff==0, 0, round(abs(pf/ops), 2))   
| stats $countPageFaultsFunc$(percent) as percent by host  
| rangemap field=percent "0-0.7"=0-0.7 "0.7-1.3"=0.7001-1.3 "1.3+"=1.3001-999999 default=abnormal  
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." dmc_group_kv_store" 
| fields serverName, machine, percent, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, percent as "Page Faults per Operation", range as "Page Fault Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_kv_store_deployment_replication_lag(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstorereplicasetstats  data.replSetStats.myState!=1 
| stats max(data.oplogInfo.end) AS local, max(data.replSetStats.myState) AS state, max(data.replSetStats.date) AS date by host 
| eval date = date/1000 
| `dmc_time_format(date)` 
| join 
  [ search `dmc_set_index_introspection` search_group=dmc_group_kv_store component=kvstorereplicasetstats data.replSetStats.myState=1 
  | stats max(data.oplogInfo.end) AS primary] 
| eval lag=(primary-local)/1000 
| eval lag = round(lag, 2) 
| `dmc_replication_lag_rangemap` 
| where range="$metric$" 
| rename host as Instance, lag as Lag, range as "Lag Range", state as State, date as "Oplog Date" 
| table Instance Lag "Oplog Date" "Lag Range" State
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_kv_store_primary_oplog_window(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$group$ search_group=dmc_group_kv_store component=kvstorereplicasetstats data.replSetStats.myState=1 
| eval Instance=host 
| rename data.oplogInfo.start as start, data.oplogInfo.end as end 
| eval start = start/1000 
| eval end = end/1000 
| eval diff= (end-start)/3600 
| `dmc_time_format(start)` 
| `dmc_time_format(end)` 
| stats first(start) as "Start Date" first(end) as "End Date" first(diff) as "Window (Hours)" by Instance
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_resource_usage_deployment_cpu_usage(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = role, group, countCPUFunc, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage component=Hostwide 
| eval total_cpu_usage = 'data.cpu_system_pct' + 'data.cpu_user_pct' 
| stats $countCPUFunc$(total_cpu_usage) as cpu_usage by host 
| `dmc_cpu_usage_rangemap` 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." $role$" 
| fields serverName, machine, cpu_usage, range, numberOfCores, ram, version, Action 
| eval cpu_usage = cpu_usage." %" 
| rename serverName as Instance, machine as Machine, cpu_usage as "CPU Usage", range as "CPU Usage Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_resource_usage_deployment_disk_usage(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = role, group, countDiskFunc, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_disk_objects component=Partitions 
| eval mount_point = 'data.mount_point' 
| eval free = if(isnotnull('data.available'), 'data.available', 'data.free') 
| eval pct_disk_usage = round(1 - free / 'data.capacity', 2) 
| eval server_mount_point = host.":".mount_point 
| stats $countDiskFunc$(pct_disk_usage) as pct_disk_usage by server_mount_point 
| `dmc_disk_usage_rangemap` 
| where range="$metric$" 
| eval host = replace(server_mount_point, ":.*", "") 
| eval mount_point = replace(server_mount_point, ".*:", "") 
| eval pct_disk_usage = pct_disk_usage * 100 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." $role$" 
| fields serverName, machine, mount_point, pct_disk_usage, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, mount_point as "Mount Point", pct_disk_usage as "Disk Usage (%)", range as "Disk Usage Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_resource_usage_deployment_load_average(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = role, group, countLoadAvgFunc, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage component=Hostwide 
| stats $countLoadAvgFunc$(data.normalized_load_avg_1min) as load_average by host 
| `dmc_load_average_rangemap` 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." $role$" 
| fields serverName, machine, load_average, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, load_average as "Load Average", range as "Load Average Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_resource_usage_deployment_memory_usage(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = role, group, countMemFunc, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage component=Hostwide 
| eval pct_mem_used = 'data.mem_used' / 'data.mem' 
| stats $countMemFunc$(pct_mem_used) as pct_mem_used by host 
| `dmc_memory_usage_rangemap` 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." $role$" 
| fields serverName, machine, pct_mem_used, range, numberOfCores, ram, version, Action 
| eval pct_mem_used = round(pct_mem_used * 100, 2) 
| eval pct_mem_used = pct_mem_used." %" 
| rename serverName as Instance, machine as Machine, pct_mem_used as "Memory Usage", range as "Memory Usage Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_search_activity_deployment_resource_usage(5)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = role, group, resourceType, resourceFunction, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage ((component=PerProcess data.search_props.sid::*) OR component=Hostwide) 
| `dmc_rename_introspection_fields` 
| eval sid = if(component=="Hostwide", "n/a", sid) 
| eval pid = if(component=="Hostwide", "n/a", pid) 
| eval pct_cpu = if(component=="Hostwide", 0, pct_cpu) 
| eval mem_used = if(component=="Hostwide", 0, 'mem_used) 
| `dmc_set_bin` 
| stats latest($resourceType$) AS resource_usage_dedup values(Action) as Action by _time, sid, pid, host 
| stats sum(resource_usage_dedup) AS sum_resource_usage values(Action) as Action by _time, host 
| stats $resourceFunction$(sum_resource_usage) as resource_usage values(Action) as Action by host 
| `dmc_$resourceType$_rangemap` 
| where range == "$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." $role$" 
| fields serverName, machine, resource_usage, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, resource_usage as "$resourceType$ Usage", range as "$resourceType$ Usage Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_drilldown_search_activity_deployment_search_concurrency(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = role, group, searchFunction, metric
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` search_group=$role$ search_group=$group$ sourcetype=splunk_resource_usage ((component=PerProcess data.search_props.sid::*) OR component=Hostwide) 
| `dmc_rename_introspection_fields` 
| `dmc_set_bin` 
| stats dc(sid) AS distinct_search_count values(Action) as Action by host, _time 
| stats $searchFunction$(distinct_search_count) as search_count values(Action) as Action by host 
| `dmc_search_count_rangemap` 
| where range="$metric$" 
| `dmc_drilldown_join_peers_by_peerURI` 
| eval Action = Action." $role$" 
| fields serverName, machine, search_count, range, numberOfCores, ram, version, Action 
| rename serverName as Instance, machine as Machine, search_count as "Count of Searches", range as "Count of Searches Range", version as Version, numberOfCores as Cores, ram as RAM
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_event_local_search_dispatch]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_audit` sourcetype=audittrail action=search search=*
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_event_remote_search_dispatch]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_internal` sourcetype=splunkd_remote_searches "Streamed search search starting"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_exclude_indexes]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _dmc_title = if(isnotnull(title), title, 'data.name')
| where NOT (_dmc_title == "history" OR _dmc_title == "_thefishbucket" OR _dmc_title == "_blocksignature")
| fields - _dmc_title
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_exclude_volumes]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _dmc_volume = if(isnotnull(title), title, 'data.name') 
| where NOT _dmc_volume == "_splunk_summaries" 
| fields - _dmc_volume
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_all_triggered_alerts(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = minute_offset
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rest splunk_server=local /servicesNS/-/splunk_monitoring_console/alerts/fired_alerts/- 
| rename savedsearch_name as title 
| join type=outer title [|rest splunk_server=local /servicesNS/-/splunk_monitoring_console/saved/searches ] 
| rename title as "Alert Name" 
| join type=outer sid [rest splunk_server=local /servicesNS/nobody/splunk_monitoring_console/search/jobs/] 
| eval now=relative_time(now(),"-$minute_offset$m") 
| where trigger_time > now 
| rename trigger_time AS "_time", description as "Description", sid AS Instance 
| convert timeformat="%b. %d, %Y %l:%M %p" ctime(_time) AS "Time Triggered" 
| fields - _time 
| fields "Alert Name", Instance, "Time Triggered", "Description"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_core_info]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval core_info = if(isnull(numberOfCores), "N/A", numberOfCores)." / ".if(isnull(numberOfVirtualCores), "N/A", numberOfVirtualCores)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_distsearch_group_servers(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rest splunk_server=local /services/search/distributed/groups 
| fields title member 
| search title="dmc_group_$group_name$" 
| eval title=replace(title, "^dmc_group_", "") 
| eval servers=mvjoin(member,",") 
| fields title servers
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_forwarder_info]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_forwarder_assets
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_forwarder_tcpin]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_internal` sourcetype=splunkd group=tcpin_connections (connectionType=cooked OR connectionType=cookedSSL) fwdType=* guid=*
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_groups]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_assets 
| fields search_group 
| dedup search_group 
| search search_group="dmc_*" 
| `dmc_set_group_label_and_sort(search_group)`
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_groups_containing_role(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = role
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_assets 
| mvcombine search_group 
| search search_group="$role$" 
| mvexpand search_group 
| fields search_group 
| dedup search_group 
| `dmc_set_group_label_and_sort(search_group)`
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_indexer_cluster_groups]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_assets 
| fields search_group 
| dedup search_group 
| search search_group="dmc_indexerclustergroup_*" 
| eval label = replace(search_group, "dmc_indexerclustergroup_", "")
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_instance_info(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_assets | mvcombine search_group | search search_group=$group$
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_instance_roles]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_assets 
| mvcombine search_group 
| eval role = search_group 
| mvexpand role 
| eval role = if(like(role, "dmc_group_%"), role, "") 
| eval role = replace(role, "^dmc_group_", "") 
| mvcombine role
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_instances_on_a_machine(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = machine
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_get_instance_info(*)` 
| where machine = "$machine$" 
| dedup serverName
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_last_hour_resource_usage_from_sid(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host, sid
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` host=$host$ sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid="$sid$" earliest=-1h 
| `dmc_set_bin` 
| `dmc_rename_introspection_fields` 
| stats latest(pct_cpu) AS pct_cpu_dedup latest(mem_used) AS mem_used_dedup by _time, pid 
| stats sum(pct_cpu_dedup) AS pct_cpu_sum sum(mem_used_dedup) AS mem_used_sum by _time 
| timechart span=10s latest(pct_cpu_sum) AS pct_cpu latest(mem_used_sum) AS mem_used
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_local_instance_asset]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_get_local_instance_asset_computed_groups` 
| join type=outer peerURI [ 
| rest splunk_server=local /services/search/distributed/groups 
| fields title member 
| where isnotnull(mvfind(member, "localhost:localhost")) 
| eval peerURI="localhost" 
| rename title AS search_groups 
| fields peerURI search_groups 
| mvcombine delim=" " search_groups] 
| makemv delim=" " search_groups 
| eval search_groups = if(isnotnull(search_groups),search_groups,computed_search_groups) 
| fields - computed_search_groups 
| mvexpand search_groups
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_local_instance_asset_computed_groups]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rest splunk_server=local /services/server/info 
| eval peerURI="localhost" 
| eval server_roles="indexer,search_head,license_master,kv_store" 
| makemv delim="," server_roles 
| mvexpand server_roles 
| eval computed_search_groups="dmc_group_".server_roles 
| stats first(peerURI) AS peerURI first(host) AS host first(host_fqdn) AS machine values(computed_search_groups) AS computed_search_groups by serverName
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_local_instance_asset_in_distributed_mode]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_get_local_instance_asset_computed_groups` 
| join type=inner peerURI [ 
| rest splunk_server=local /services/search/distributed/groups 
| fields title member 
| where isnotnull(mvfind(member, "localhost:localhost")) 
| eval peerURI="localhost" 
| rename title AS search_groups 
| fields peerURI search_groups 
| mvcombine delim=" " search_groups] 
| makemv delim=" " search_groups 
| eval search_groups = if(isnotnull(search_groups),search_groups,computed_search_groups) 
| fields - computed_search_groups 
| mvexpand search_groups
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_machine_info]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_get_instance_info(*)` 
| stats first(host) as host first(serverName) as serverName by machine
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_port_from_splunktcp_stanza(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = stanza_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = | rex field=$stanza_name$ "splunktcp(-ssl)?:(\/{1,2})?(([0-9]{1,3}\.){3}[0-9]{1,3})?(:)?(?<port>\d+)" 
| eval port = if(match($stanza_name$, "splunktcp-ssl"), port." (SSL)", port) 
| eval port = if(isnotnull(port), port, null)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_recently_triggered_alerts]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rest splunk_server=local /servicesNS/-/splunk_monitoring_console/saved/searches 
|rename title as savedsearch_name 
| fields savedsearch_name, triggered_alert_count, description 
| where triggered_alert_count > 0 
| join type=outer savedsearch_name[|rest splunk_server=local /servicesNS/-/splunk_monitoring_console/alerts/fired_alerts/- 
| cluster field=savedsearch_name] 
| join type=outer sid [rest splunk_server=local /servicesNS/nobody/splunk_monitoring_console/search/jobs/] 
| rename savedsearch_name AS "Alert Name", triggered_alert_count AS "Trigger Count", published AS "Last time triggered", description as "Description" | fields "Alert Name" , "Trigger Count", "Last time triggered", "Description", sid
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_search_head_cluster_groups]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_assets 
| fields search_group 
| dedup search_group 
| search search_group="dmc_searchheadclustergroup_*" 
| eval label = replace(search_group, "dmc_searchheadclustergroup_", "")
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_get_warnings_and_errors(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = search_group, component
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_internal` search_group=$search_group$ sourcetype=splunkd component=$component$  (log_level=WARN OR log_level=ERROR)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_indexing_rate_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=kbps "0-50 KB/s"=0-50 "50-100 KB/s"=50.001-100 "100-500 KB/s"=100.001-500 "500 KB/s - 1 MB/s"=500.001-1024 "1-2.5 MB/s"=1024.001-2560 "2.5-5 MB/s"=2560.001-5120 "5-10 MB/s"=5120.001-10240 "10+ MB/s"=10240.001-999999 default="NULL"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_indexing_rate_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_indexing_rate_rangemap` 
| timechart minspan=30s partial=f dc(host) AS instance_count by range 
| fields _time "10+ MB/s" "5-10 MB/s" "2.5-5 MB/s" "1-2.5 MB/s" "500 KB/s - 1 MB/s" "100-500 KB/s" "50-100 KB/s" "0-50 KB/s"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_instances_view_default_search(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = inputlookup dmc_assets 
| mvcombine search_group 
| rex max_match=0 field=search_group "dmc_indexerclustergroup_(?<indexer_cluster>.*)" 
| rex max_match=0 field=search_group "dmc_searchheadclustergroup_(?<search_head_cluster>.*)" 
| mvexpand search_group 
| search search_group = $group$ 
| mvcombine search_group 
| join type=outer peerURI 
  [| rest splunk_server=local /services/search/distributed/peers 
   | rename title as peerURI ] 
| join type=outer peerURI 
  [| rest splunk_server=local /services/server/info 
   | eval peerURI = "localhost" 
   | eval status = "Up"] 
| join peerURI 
  [| `dmc_get_instance_roles` ] 
| eval status = if(status == "Up", status, "Unreachable") 
| eval Action = serverName." ".role 
| eval OS = os_name 
| eval ram = round(physicalMemoryMB / 1024, 2)." GB" 
| `dmc_get_core_info` 
| fields serverName, machine, role, indexer_cluster, search_head_cluster, OS, core_info, ram, version, status, Action 
| sort status, serverName 
| rename serverName as Instance, machine as Machine, role as Role, indexer_cluster as "Indexer Cluster", search_head_cluster as "Search Head Cluster", core_info as "CPU Cores (Physical / Virtual)", ram as RAM, version as Version, status as Status
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_iostats_rangemap(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = fieldname
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=$fieldname$ "0-60%"=0-60 "60-80%"=60.0001-80, "80-100%"=80.0001-100 default=abnormal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_base_summary(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host, pool_clause
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_internal` host=$host$ source=*license_usage.log* type="RolloverSummary" earliest=-30d@d $pool_clause$
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_base_usage(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host, pool_clause
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_internal` source=*license_usage.log* type="Usage" | eval h=if(len(h)=0 OR isnull(h),"(SQUASHED)",h) | eval s=if(len(s)=0 OR isnull(s),"(SQUASHED)",s) | eval idx=if(len(idx)=0 OR isnull(idx),"(UNKNOWN)",idx) | bin _time span=1d | stats sum(b) as b by _time, host, pool, s, st, h, idx | search host=$host$ $pool_clause$
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_pool_size_srch(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host, pool_clause
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = join type=outer _time [search `dmc_set_index_internal` host=$host$ source=*license_usage.log* type="RolloverSummary" earliest=-30d@d $pool_clause$ | eval _time=_time - 43200 | bin _time span=1d | stats latest(poolsz) AS  "pool size" by _time] | fields - _timediff
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_stack_size_srch(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host, pool_clause
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = join type=outer _time [search `dmc_set_index_internal` host=$host$ source=*license_usage.log* type="RolloverSummary" earliest=-30d@d | eval _time=_time - 43200 | bin _time span=1d | dedup _time stack | stats sum(stacksz) AS "stack size" by _time] | fields - _timediff
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summary_maxavg_indxr(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, split_by_field_name, split_by_label
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | eval slave_guid=slave | stats sum(b) AS volume by slave_guid, _time | stats avg(volume) AS avgVolume max(volume) AS maxVolume by slave_guid | join type=outer slave_guid [rest splunk_server=$splunk_server$ /services/licenser/slaves | rename label AS slave_name title AS slave_guid | table slave_guid slave_name] | eval slave_name = if(isnotnull(slave_name),slave_name,"GUID: ".slave_guid) | foreach *Volume [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)] |  rename slave_name as "Indexer" avgVolume AS "average" maxVolume AS "peak" | sort 5 - "average" | fields "Indexer", "average", "peak" | fields - _timediff, slave_guid
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summary_maxavg_no_split(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, split_by_field_name, split_by_label
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | stats sum(b) AS volume by _time | stats avg(volume) AS avgVolume max(volume) AS maxVolume  | eval maxVolumeGB=round(maxVolume/1024/1024/1024,3) | eval avgVolumeGB=round(avgVolume/1024/1024/1024,3) | rename avgVolumeGB AS "average" maxVolumeGB AS "peak" | eval "All Pools" = "" | fields "All Pools", "average", "peak"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summary_maxavg_pool(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, split_by_field_name, split_by_label
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | stats sum(b) AS volume by pool, _time  | stats avg(volume) AS avgVolume max(volume) AS maxVolume by pool | eval maxVolumeGB=round(maxVolume/1024/1024/1024,3) | eval avgVolumeGB=round(avgVolume/1024/1024/1024,3) | rename avgVolumeGB AS "average" maxVolumeGB AS "peak" pool as "Pool" | fields "Pool", "average", "peak" | sort 5 - "average"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summery_indxr(5)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, size_search, host, pool_clause, split_by_field_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | eval slave_guid=slave | stats max(b) AS volume by slave_guid, _time | join type=outer slave_guid [rest splunk_server=$splunk_server$ /services/licenser/slaves | rename label AS slave_name title AS slave_guid | table slave_guid slave_name] | eval slave_name = if(isnotnull(slave_name),slave_name,"GUID: ".slave_guid) | timechart span=1d max(volume) AS "volume" by slave_name fixedrange=false | `$size_search$($host$, "$pool_clause$")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summery_no_split(5)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, size_search, host, pool_clause, split_by_field_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | timechart span=1d sum(b) AS "volume" fixedrange=false | `$size_search$($host$, "$pool_clause$")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summery_pct_indxr(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, sz_clause, host, split_by_field_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats sum(b) AS volumeB max($sz_clause$) AS $sz_clause$ by slave, _time | eval pctused=round(volumeB/$sz_clause$*100,2) | eval slave_guid=slave | join type=outer slave_guid [rest splunk_server=$splunk_server$ /services/licenser/slaves | rename label AS slave_name title AS slave_guid | table slave_guid slave_name] | eval slave_name = if(isnotnull(slave_name),slave_name,"GUID: ".slave_guid) | timechart span=1d max(pctused) AS "used" by slave_name fixedrange=false
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summery_pct_no_split(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, sz_clause, host, split_by_field_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats sum(b) AS volumeB max($sz_clause$) AS $sz_clause$ by _time | eval pctused=round(volumeB/$sz_clause$*100,2) | timechart span=1d max(pctused) AS "used" fixedrange=false
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summery_pct_pool(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, sz_clause, host, split_by_field_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats sum(b) AS volumeB max($sz_clause$) AS $sz_clause$ by pool, _time | eval pctused=round(volumeB/$sz_clause$*100,2) | timechart span=1d max(pctused) AS "used" by pool fixedrange=false
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_summery_pool(5)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, size_search, host, pool_clause, split_by_field_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval _time=_time - 43200 | bin _time span=1d | stats latest(b) AS b by slave, pool, _time | timechart span=1d sum(b) AS "volume" by pool fixedrange=false | `$size_search$($host$, "$pool_clause$")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_usage_all(5)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, size_search, host, split_by_field_name, pool_clause
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = timechart span=1d sum(b) AS volumeB by $split_by_field_name$ fixedrange=false | `$size_search$($host$, "$pool_clause$")` | foreach * [eval <<FIELD>>=round('<<FIELD>>'/1024/1024/1024, 3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_usage_maxavg_all(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, split_by_field_name, split_by_label
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = stats sum(b) AS volume by $split_by_field_name$, _time | stats avg(volume) AS avgVolume max(volume) AS maxVolume by $split_by_field_name$ | eval avgVolumeGB=round(avgVolume/1024/1024/1024,3) | eval maxVolumeGB=round(maxVolume/1024/1024/1024,3) | fields $split_by_field_name$, avgVolumeGB, maxVolumeGB | rename avgVolumeGB AS "average" maxVolumeGB AS "peak" $split_by_field_name$ AS "$split_by_label$" | sort 5 - "average"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_licensing_usage_pct_all(4)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = splunk_server, sz_clause, host, split_by_field_name
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = join _time pool type=outer [search `dmc_set_index_internal` host=$host$ source=*license_usage.log* type="RolloverSummary" earliest=-30d@d | eval _time=_time - 43200 | bin _time span=1d | stats latest($sz_clause$) AS $sz_clause$ by slave, pool, _time | stats max($sz_clause$) AS $sz_clause$ by pool, _time] | stats sum(b) AS bytes_used max($sz_clause$) AS $sz_clause$ by $split_by_field_name$, _time | timechart span=1d max(eval(round(bytes_used/$sz_clause$*100,2))) by $split_by_field_name$ fixedrange=false
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_load_average_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=load_average "0-20"=0-20 "20-50"=20.001-50 "50+"=50.001-999999 default=abnormal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_load_average_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_load_average_rangemap` 
| `dmc_timechart` partial=f dc(server) as server_count by range 
| fields _time, "50+", "20-50", "0-20"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_match_all_scheduled_search_types]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = ((data.search_props.type="datamodel acceleration" OR search_props.type="datamodel acceleration") OR (data.search_props.type="report acceleration" OR search_props.type="report acceleration") OR (data.search_props.type="scheduled" OR search_props.type="scheduled") OR (data.search_props.type="summary indexing" OR search_props.type="summary indexing"))
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_mem_used_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=resource_usage 
"0GB"=0-0 
"<1GB"=0.01-1024 
"1-2GB"=1024.001-2048 
"2-3GB"=2048.001-3072 
"3-4GB"=3072.001-4096 
"4-5GB"=4096.001-5120 
"5-10GB"=5120.001-10240 
"10-15GB"=10240.001-15360 
"15-20GB"=15360.001-20480 
"20-30GB"=20480.001-30720 
"30GB+"=30720.001-999999 
default="0GB" 
| eval resource_usage = round(resource_usage / 1024, 3)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_mem_used_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_mem_used_rangemap` 
| `dmc_timechart` partial=f dc(host) AS host_count by range 
| fields _time, "30GB+" "20-30GB" "15-20GB" "5-10GB" "4-5GB" "3-4GB" "2-3GB" "1-2GB" "<1GB" "0GB"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_memory_usage_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=pct_mem_used "0-60%"=0-0.6 "60-80%"=0.6001-0.8 "80-100%"=0.8001-1 default=abnormal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_memory_usage_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_memory_usage_rangemap` 
| `dmc_timechart` partial=f dc(server) as server_count by range 
| fields _time, "80-100%", "60-80%", "0-60%"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_pct_cpu_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=resource_usage 
"0 cores"=0-0.009 
"0.01-1 cores"=0.01-1 
"1-2 cores"=1.01-2 
"2-3 cores"=2.01-3 
"3-4 cores"=3.01-4 
"4-5 cores"=4.01-5 
"5-10 cores"=5.01-10 
"10-15 cores"=10.01-15 
"15-20 cores"=15.01-20 
"20-25 cores"=20.01-25 
"25-30 cores"=25.01-30 
"30+ cores"=30.01-999 
"negative"=-99999--0.001 
default="0 cores"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_pct_cpu_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_pct_cpu_rangemap` 
| `dmc_timechart` partial=f dc(host) AS host_count by range 
| fields _time, "30+ cores" "25-30 cores" "20-25 cores" "15-20 cores" "10-15 cores" "5-10 cores" "4-5 cores" "3-4 cores" "2-3 cores" "1-2 cores" "0.01-1 cores" "0 cores"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_queue_fill_ratio_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=fill_percentage "0-60%"=0-60 "60-80%"=60.01-80 "80-100%"=80.01-100
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_queue_fill_ratio_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_queue_fill_ratio_rangemap` 
| timechart partial=f dc(host) by range 
| fields _time "80-100%" "60-80%" "0-60%"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_cpu_system_pct]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=cpu_system_pct #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_default_cpu_system_pct]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=cpu_system_pct #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_default_indexing_rate]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=average_KBps #CEE4EE=0-99.999 #6BAECA=100-999.999 #0877A6=1000-4999 #005E86=5000-9999 default=#004664
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_default_mem_used]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=mem_used #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_default_search_concurrency]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=search_concurrency #CEE4EE=0-5.999 #6BAECA=6-10.999 #0877A6=11-20.999 default=#005E86
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_default_up_down_status]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=up_down_status #DC4E41=0-0.999 default=#53A051
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_indexing_rate]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=average_KBps #CEE4EE=0-99.999 #6BAECA=100-999.999 #0877A6=1000-4999 #005E86=5000-9999 default=#004664
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_mem_used]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=mem_used #53A051=0-59.999 #F1813F=60-79.999 default=#DC4E41
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_search_concurrency]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=search_concurrency #CEE4EE=0-5.999 #6BAECA=6-10.999 #0877A6=11-20.999 default=#005E86
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rangemap_up_down_status]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=up_down_status #DC4E41=0-0.999 default=#53A051
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_re_build_forwarder_assets(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = sparkline_span
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_build_forwarder_assets($sparkline_span$)` 
| rename new_sum_kb as sum_kb, new_avg_tcp_kbps_sparkline as avg_tcp_kbps_sparkline, new_avg_tcp_kbps as avg_tcp_kbps, new_avg_tcp_eps as avg_tcp_eps 
| eval avg_tcp_kbps_sparkline = "N/A" 
| addinfo 
| eval status = if(isnull(sum_kb) or (sum_kb <= 0) or (last_connected < (info_max_time - 900)), "missing", "active") 
| eval sum_kb = round(sum_kb, 2) 
| eval avg_tcp_kbps = round(avg_tcp_kbps, 2) 
| eval avg_tcp_eps = round(avg_tcp_eps, 2) 
| fields guid, hostname, forwarder_type, version, arch, os, status, last_connected, sum_kb, avg_tcp_kbps_sparkline, avg_tcp_kbps, avg_tcp_eps 
| outputlookup dmc_forwarder_assets
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_re_build_forwarder_assets_light(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = sparkline_span
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_build_forwarder_assets($sparkline_span$)` 
| rename new_sum_kb as sum_kb, new_avg_tcp_kbps_sparkline as avg_tcp_kbps_sparkline, new_avg_tcp_kbps as avg_tcp_kbps, new_avg_tcp_eps as avg_tcp_eps 
| eval avg_tcp_kbps_sparkline = "N/A" 
| addinfo 
| eval status = if(isnull(sum_kb) or (sum_kb <= 0) or (last_connected < (relative_time(now(),"-15m"))), "missing", "active") 
| eval sum_kb = round(sum_kb, 2) 
| eval avg_tcp_kbps = round(avg_tcp_kbps, 2) 
| eval avg_tcp_eps = round(avg_tcp_eps, 2) 
| fields guid, hostname, forwarder_type, version, arch, os, status, last_connected, sum_kb, avg_tcp_kbps_sparkline, avg_tcp_kbps, avg_tcp_eps 
| outputlookup dmc_forwarder_assets
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rename_forwarder_type(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = type
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval $type$ = case($type$ == "full", "Heavy Forwarder", $type$ == "uf", "Universal Forwarder", $type$ == "lwf", "Light Forwarder", 1==1, $type$)
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_rename_introspection_fields]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval process = 'data.process' 
| eval args = 'data.args' 
| eval pid = 'data.pid' 
| eval ppid = 'data.ppid' 
| eval elapsed = 'data.elapsed' 
| eval mem_used = 'data.mem_used' 
| eval mem = 'data.mem' 
| eval pct_memory = 'data.pct_memory' 
| eval pct_cpu = 'data.pct_cpu' 
| eval sid = 'data.search_props.sid' 
| eval app = 'data.search_props.app' 
| eval label = 'data.search_props.label' 
| eval type = 'data.search_props.type' 
| eval mode = 'data.search_props.mode' 
| eval user = 'data.search_props.user' 
| eval role = 'data.search_props.role' 
| eval label = if(isnotnull('data.search_props.label'), 'data.search_props.label', "") 
| eval provenance = if(isnotnull('data.search_props.provenance'), 'data.search_props.provenance', "unknown") 
| eval search_head = case(isnotnull('data.search_props.search_head') AND 'data.search_props.role' == "peer", 'data.search_props.search_head', isnull('data.search_props.search_head') AND 'data.search_props.role' == "head", "_self", isnull('data.search_props.search_head') AND 'data.search_props.role' == "peer", "_unknown") 
| eval workload_pool = if(isnotnull('data.workload_pool'), 'data.workload_pool', "UNDEFINED")
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_replication_lag_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=lag "0-10s"=0-10 "10-30s"=10.001-30 ">30s"=30.001-10000000 default=abnormal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_resource_usage_by_processes_timechart(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = resource_type, function
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_bin` 
| `dmc_rename_introspection_fields` 
| stats latest($resource_type$) AS resource_usage_dedup latest(process_class) AS process_class by pid, _time 
| stats sum(resource_usage_dedup) AS resource_usage by _time, process_class 
| timechart minspan=10s $function$(resource_usage) AS "Resource Usage" by process_class
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_resource_usage_instance_drilldown(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` sourcetype=splunk_resource_usage component=PerProcess host=$host$ 
| `dmc_rename_introspection_fields` 
| `dmc_classify_processes` 
| eval args = if(isnotnull(sid),"search --id=".sid." (...)", args) 
| eval cmd = process." ".args 
| stats latest(pid) as "PID", latest(ppid) as "PPID", latest(label) as Label, latest(provenance) as Provenance, latest(search_head) as "Search Head", latest(type) as Type, latest(user) as User, latest(app) as App, latest(mode) as Mode, latest(role) as Role, avg(pct_cpu) as avg_pct_cpu, max(mem_used) as "Physical Memory Usage (MB)", min(_time) as min_time, max(_time) as max_time, max(elapsed) as "Elapsed Time" by cmd 
| eval avg_pct_cpu = round(avg_pct_cpu, 2) 
| `dmc_time_format(min_time)` 
| `dmc_time_format(max_time)` 
| rename avg_pct_cpu as "Average CPU Usage (%)", min_time as "First Time Seen", max_time as "Last Time Seen"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_scheduler_instance_search_concurrency_drilldown(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host, concurrencySplitBy, type
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` host=$host$ sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid::* `dmc_match_all_scheduled_search_types` 
| `dmc_rename_introspection_fields` 
| where $concurrencySplitBy$=="$type$" 
| stats latest(pid) as "PID", latest(ppid) as "PPID", latest(label) as Label, latest(provenance) as Provenance, latest(search_head) as "Search Head", latest(type) as Type, latest(user) as User, latest(app) as App, latest(mode) as Mode, latest(role) as Role, avg(pct_cpu) as avg_pct_cpu, max(mem_used) as "Physical Memory Usage (MB)", min(_time) as min_time, max(_time) as max_time, max(elapsed) as "Elapsed Time" by sid 
| eval avg_pct_cpu = round(avg_pct_cpu, 2) 
| `dmc_time_format(min_time)` 
| `dmc_time_format(max_time)` 
| rename avg_pct_cpu as "Average CPU Usage (%)", min_time as "First Time Seen", max_time as "Last Time Seen"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_search_activity_instance_drilldown(3)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = host, concurrencySplitBy, type
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_set_index_introspection` host=$host$ sourcetype=splunk_resource_usage component=PerProcess data.search_props.sid::* 
| `dmc_rename_introspection_fields` 
| where $concurrencySplitBy$=="$type$" 
| stats latest(pid) as "PID", latest(ppid) as "PPID", latest(label) as Label, latest(provenance) AS Provenance, latest(search_head) as "Search Head", latest(type) as Type, latest(user) as User, latest(app) as App, latest(mode) as Mode, latest(role) as Role, avg(pct_cpu) as avg_pct_cpu, max(mem_used) as "Physical Memory Usage (MB)", min(_time) as min_time, max(_time) as max_time, max(elapsed) as "Elapsed Time" by sid 
| eval avg_pct_cpu = round(avg_pct_cpu, 2) 
| `dmc_time_format(min_time)` 
| `dmc_time_format(max_time)` 
| rename avg_pct_cpu as "Average CPU Usage (%)", min_time as "First Time Seen", max_time as "Last Time Seen"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_search_count_rangemap]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = rangemap field=search_count "0"=0-0 "1-5"=1-5 "6-10"=6-10 "11-15"=11-15 "16-20"=16-20 "21-30"=21-30 "31-40"=31-40 "41-50"=41-50 "51-75"=51-75 "76-100"=76-100 "101+"=101-99999
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_search_count_rangemap_and_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_search_count_rangemap` 
| `dmc_timechart` dc(host) AS count_host by range 
| fields _time "101+" "76-100" "51-75" "41-50" "31-40" "21-30" "16-20" "11-15" "6-10" "1-5" "0"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_bin]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = bin _time span=10s
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_bin_for_disk_usage]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = bin _time span=10min
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_bin_for_iostats]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = bin _time minspan=1min
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_bin_for_metrics_log]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = bin _time minspan=30s
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_bin_for_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = bin _time minspan=10s
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_bin_for_timechart_for_disk_usage]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = bin _time minspan=10min
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_group_label_and_sort(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = search_group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval label = replace($search_group$, "^dmc_\w*group_", "") 
| eval label = case( 
    $search_group$ == "dmc_group_indexer", "Indexer", 
    $search_group$ == "dmc_group_search_head", "Search Head", 
    $search_group$ == "dmc_group_cluster_master", "Cluster Master", 
    $search_group$ == "dmc_group_license_master", "License Master", 
    $search_group$ == "dmc_group_deployment_server", "Deployment Server", 
    $search_group$ == "dmc_group_kv_store", "KV Store", 
    $search_group$ == "dmc_group_shc_deployer", "SHC Deployer", 
    like($search_group$, "dmc_customgroup_%"), label."  (custom)", 
    like($search_group$, "dmc_indexerclustergroup_%"), label." (Indexer Cluster)", 
    like($search_group$, "dmc_searchheadclustergroup_%"), label." (Search Head Cluster)", 
    1 == 1, label." (Unrecognized)") 
| eval order = case( 
    like($search_group$, "dmc_group_%"), 100, 
    like($search_group$, "dmc_customgroup_%"), 200, 
    like($search_group$, "dmc_indexerclustergroup_%"), 300, 
    like($search_group$, "dmc_searchheadclustergroup_%"), 400, 
    1 == 1, "500") 
| sort order, $search_group$ 
| fields - order
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_index_audit]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = index=_audit
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_index_internal]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = index=_internal
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_set_index_introspection]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = index=_introspection
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_tcp_forwarder_count_split_by(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = field, group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_get_forwarder_tcpin` search_group=dmc_group_indexer search_group=$group$ 
| `dmc_timechart_for_metrics_log` dc(guid) as forwarder_count by $field$ 
| rename forwarder_count as "Forwarder Count"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_tcp_throughput_split_by(2)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = field, group
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = `dmc_get_forwarder_tcpin` search_group=dmc_group_indexer search_group=$group$ 
| `dmc_timechart_for_metrics_log` per_second(kb) as avg_tcp_KBps by $field$ 
| rename avg_tcp_KBps as "KB/s"
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_time_format(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = time
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = eval $time$ = strftime($time$, "%m/%d/%Y %H:%M:%S %z")
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_timechart]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = timechart minspan=10s
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_timechart_for_disk_usage]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = timechart minspan=10min
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_timechart_for_iostats]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = timechart minspan=60s partial=f
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_timechart_for_metrics_log]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = timechart minspan=30s
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [dmc_timechart_for_metrics_reaper_and_heartbeat]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = timechart minspan=300s
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              [domain_input]
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              definition = index=dga_proxy
/data/splunk/splunk/etc/apps/dga_analysis/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [ensure_single_value(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = field
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = | stats max($field$) as $field$, c($field$) as field_size | eval $field$=if(field_size > 0, $field$, 0) | fields $field$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [entity_filter_rule_mvevals]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = rename entity_info.alias_value AS alias_values | mvexpand entity_filtering_field | mvexpand alias_values
  | eval matched_alias_values=if(isnull(alias_values),"`no_entities_matched`", entity_filtering_field."="."\"".alias_values."\"")
  | mvcombine matched_alias_values | eval results=mvjoin(matched_alias_values," OR ") | table results
  | mvcombine results | eval value=mvjoin(results," OR ")
  | appendpipe [stats count | where count=0] | eval value=if(isnull(count),value,"`no_entities_matched`")
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [entity_level_kpi_only]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = indexed_is_service_aggregate::0
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_eventstats-counts(3)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = eventstats_ops, condition1, condition2
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = eventstats $eventstats_ops$($condition1$) as EventCount, $eventstats_ops$($condition2$) as Total
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get-application_id(3)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = packageName,platform,appEnvironment
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = eval application_id=`euem_get-application_key($packageName$,$platform$,$appEnvironment$,.)`
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get-application_key(4)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = packageName,platform,appEnvironment,seperator
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tostring($packageName$)."$seperator$".tostring($platform$)."$seperator$".tostring($appEnvironment$)
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              errormsg = "Argument should not be null"
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              validation = isnotnull
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get-application_title(3)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = packageName,platform,appEnvironment
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = eval application_title=`euem_get-application_key($packageName$,$platform$,$appEnvironment$,-)`
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get-counts(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = condition1, condition2
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = `euem_get-counts(count,$condition1$,$condition2$)`
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get-counts(3)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = eventstats_ops, condition1, condition2
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = eventstats $eventstats_ops$($condition1$) as EventCount, $eventstats_ops$($condition2$) as Total
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get-rate(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = occurrence, total_occurrences
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = eval percentage=if(`is_invalid_ratio($occurrence$, $total_occurrences$)`,0,$occurrence$/$total_occurrences$*100) | eval percentage=round(percentage, 4) | eval percentage=min(percentage, 100)
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_crash_rate(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem application_id="$application_id$" | bucket _time span=1h | eventstats count(eval(handled="false")) as CrashCount, dc(session_id) as Total by _time, $entity_field$ | fillnull CrashCount, Total | `evaluate_percentage(CrashRate, CrashCount, Total)` | timechart avg(CrashRate) by $entity_field$ span=1h
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_geolocation(1)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = ip
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = iplocation allfields=true $ip$
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_http_error_rate(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem tag=performance application_id="$application_id$" | bucket _time span=1h | eventstats count(eval(status_code>299)) as ErrorCount, count(eval(status_code>=0)) as Total by _time, $entity_field$ | fillnull ErrorCount, Total | `evaluate_percentage(HTTPErrorRate, ErrorCount, Total)` | timechart avg(HTTPErrorRate) by $entity_field$ span=1h
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_network_error_rate(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem tag=performance application_id="$application_id$" | bucket _time span=1h | eventstats count(eval(exception!="NA")) as ErrorCount, count(eval(status_code>=0)) as Total by _time, $entity_field$ | fillnull ErrorCount, Total | `evaluate_percentage(NetworkErrorRate, ErrorCount, Total)` | timechart avg(NetworkErrorRate) by $entity_field$ span=1h
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_network_latency(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem tag=performance application_id="$application_id$" | timechart avg(latency) as "Average Network latency" by $entity_field$
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_pageload_time(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem tag=performance application_id="$application_id$" | timechart avg(dom_processing_time) as "Average Page Load Time" by $entity_field$
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_session_duration(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem application_id="$application_id$" | timechart avg(ses_duration) as "Session Length" by $entity_field$
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_unique_sessions_count(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem application_id="$application_id$" | timechart dc(session_id) as "Session Count" by $entity_field$
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_get_unique_user_count(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = entity_field, application_id
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = tag=euem application_id="$application_id$" | timechart dc(uuid) as "Unique Users" by $entity_field$
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [euem_timechart-counts(3)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = timechart_ops, field, entity_field
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = timechart $timechart_ops$($field$) as Aggregate_count by $entity_field$
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [evaluate_percentage(3)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = fieldname, occurrence, total_occurrences
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = eval $fieldname$=if($total_occurrences$=0, 0, round($occurrence$/$total_occurrences$*100, 4))
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [fill_aggregate_gaps(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = kpi_key
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_service_aggregate_cached_alert_value($kpi_key$)` | eval alert_value=coalesce(alert_value, cached_alert_value), kpi_id="$kpi_key$", entity_title="service_aggregate" | `write_latest_results_to_kpi_cache` | eval is_service_aggregate="1", is_entity_defined="0", entity_key="service_aggregate" | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [fill_entity_gaps(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field, kpi_key
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_entities_cached_alert_value($entity_field$, $kpi_key$)` | eval alert_value=coalesce(alert_value, cached_alert_value), entity_split_field="$entity_field$", kpi_id="$kpi_key$" | rename $entity_field$ as entity_title | `write_latest_results_to_kpi_cache` | rename entity_title as $entity_field$ | fields - entity_split_field | `gettime`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [fill_gaps_aggregate_backfill(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = alert_period
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = fillgapsbackfill kpi_type="service_aggregate", alert_period="$alert_period$"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [fill_gaps_entity_backfill(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_split_field, alert_period
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = fillgapsbackfill entity_split_field="$entity_split_field$", alert_period="$alert_period$"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [filter_maintenance_entities]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = where IsNull(is_entity_in_maintenance) OR (is_entity_in_maintenance != 1)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [filter_maintenance_services(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_ids
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval service_ids = "$service_ids$" | makemv delim="," service_ids | mvexpand service_ids | `is_object_in_maintenance("service", service_ids)` | where IsNull(in_maintenance) OR (in_maintenance != 1) | fields - in_maintenance | mvcombine service_ids | fields - service_ids
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [forecastviz(4)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = ft, hb, v, ci
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _ft=$ft$, _hb=$hb$, _vars="$v$", _ci=$ci$
/data/splunk/splunk/etc/apps/DA-ITSI-OS/default/macros.conf                [get-closest-disk-unit(1)]
/data/splunk/splunk/etc/apps/DA-ITSI-OS/default/macros.conf                args = field
/data/splunk/splunk/etc/apps/DA-ITSI-OS/default/macros.conf                definition = eval unit_to_use = case( 
    $field$ >= (1024*1024*1024), "PB", 
    $field$ >= (1024*1024), "TB", 
    $field$ >= (1024), "GB", 
    1=1, "MB") 
| eval divisor = case( 
    unit_to_use = "PB", 1024*1024*1024, 
    unit_to_use = "TB", 1024*1024, 
    unit_to_use = "GB", 1024, 
    unit_to_use = "MB", 1)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [getPercentage(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = period, occurrence
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval alert_period = coalesce($period$, 1) | `getSearchTimeDiff` | eval timeDiffInMin = timeDiff/60 | eval total_occurrences = floor(timeDiffInMin/alert_period) | eval percentage=$occurrence$/total_occurrences*100 | eval percentage=round(percentage, 4) | eval percentage=min(percentage, 100)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [getSearchTimeDiff]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | eval timeDiff = info_max_time-info_min_time | fields - info_min_time info_max_time info_search_time info_sid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_all_kpi_status]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_kpi_status(*)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_anomaly_detection_index]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=anomaly_detection
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_entities_cached_alert_value(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field, kpi_key
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = inputlookup append=t itsi_kpi_alert_value_cache where (kpi_id="$kpi_key$" AND entity_split_field="$entity_field$" AND entity_title!="service_aggregate") | eval $entity_field$=coalesce($entity_field$, entity_title), mod_time=if(isnull(mod_time), now(), mod_time) | fields - entity_title, kpi_id | stats first(entity_split_field) as entity_split_field first(alert_value) as alert_value first(cached_alert_value) as cached_alert_value max(mod_time) as mod_time by $entity_field$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_full_itsi_summary_kpi(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = kpiid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` indexed_itsi_kpi_id::$kpiid$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_full_itsi_summary_service(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = serviceid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` indexed_itsi_service_id::$serviceid$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_itsi_summary_index]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index="itsi_summary"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_kpi_status(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = severity_name
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` alert_severity="$severity_name$" `service_level_kpi_only` | stats latest(alert_severity) as alert_severity latest(alert_color) as severity_color by kpiid | stats count as severity_count first(severity_color) as severity_color by alert_severity | rename alert_severity AS severity_name
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_kpi_urgency(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = getservice service=$sid$ | rex field=services_depends_on "kpis=(?<kpiid>.*)"
| fields kpiid | eval kpiid=if(like(kpiid, "%,%"), split(kpiid, ","), kpiid)
| mvexpand kpiid | append [| getservice service=$sid$ | fields kpis  | mvexpand kpis
| rex field=kpis "id=(?<kpiid>.*)~~~urgency=(?<urgency>.*)" | fields - kpis | search kpiid!=SHKPI-$sid$]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_name_from_kv(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = input_id_field, output_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = lookup alarm_console_lookup _key AS $input_id_field$ OUTPUT title AS $output_field$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_notable_event_state]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = lookup itsi_notable_event_state_lookup _key AS event_id OUTPUT severity AS lookup_severity, owner AS lookup_owner, status AS lookup_status | eval severity=if(isnull(lookup_severity), severity, lookup_severity), status=if(isnull(lookup_status), status, lookup_status), owner=if(isnull(lookup_owner), owner, lookup_owner) | fields - lookup_*
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_only_itsi_summary_kpi(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = kpiid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = indexed_itsi_kpi_id::$kpiid$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_only_itsi_summary_service(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = serviceid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = indexed_itsi_service_id::$serviceid$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_service_aggregate_cached_alert_value(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = kpi_key
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = inputlookup append=true itsi_kpi_alert_value_cache where (kpi_id="$kpi_key$" AND entity_title="service_aggregate") | eval mod_time=if(isnull(mod_time), now(), mod_time) | stats first(alert_value) as alert_value first(entity_title) as entity_title first(kpi_id) as kpi_id first(cached_alert_value) as cached_alert_value max(mod_time) as mod_time
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_service_health_for_name(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_name
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `service_health_data` [ stats count | inputlookup append=t service_kpi_lookup where title="$service_name$" | rename _key as itsi_service_id | fields itsi_service_id count | eventstats count | eval itsi_service_id=if(count<2, "NO SERVICE FOUND",itsi_service_id) | search itsi_service_id=* | table itsi_service_id ]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [get_service_name(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = input_id_field, output_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_name_from_kv($input_id_field$, $output_field$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [gettime]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `HandleInfoMaxTime` | eval _time=info_max_time | fields - info_min_time info_max_time info_search_time info_sid
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf [group_filter(1)]
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf args = group_id
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf definition = | inputlookup em_groups where _key=$group_id$ 
| table filter 
| makemv delim="," filter 
| mvexpand filter 
| rex field=filter "(?<dim>.*)=(?<val>.*)" 
| table dim, val 
| stats values(val) by dim 
| transpose 0 header_field=dim 
| fields - column
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf description = A macro command that replaces a group title with its filter information. It is internally used by SAI in alert creation.
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [has_all_events]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = addinfo | lookup itsi_notable_group_system_lookup _key AS itsi_group_id OUTPUT start_time last_time | eval has_all_events=if(info_max_time>last_time AND info_min_time<start_time,1,0) | fields - info_max_time, info_min_time, info_search_time, info_sid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [health_score_data]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` source=service_health_monitor
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [health_score_histogram(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `health_score_data` indexed_itsi_service_id::$sid$ kpi=ServiceHealthScore
  | timechart limit=0 span=5m avg(health_score) BY kpi | `histogram(ServiceHealthScore,100)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [health_score_level_prediction_output]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = appendpipe
  [| fields next30m_avg_hsl, next30m_worst_hsl, "predicted(next30m_avg_hsl)", "predicted(next30m_worst_hsl)"
    | appendpipe [fields next30m_worst_hsl, "predicted(next30m_worst_hsl)"
    | rename next30m_worst_hsl as next30m_avg_hsl,
      "predicted(next30m_worst_hsl)" as "predicted(next30m_avg_hsl)"]
    | `classificationstatistics(next30m_avg_hsl, "predicted(next30m_avg_hsl)")`
    | rename accuracy as last30m_avg_hsl, precision as now_avg_hsl, recall as next30m_avg_hsl,
      f1 as last30m_worst_hsl, count as now_worst_hsl]
  | stats last(last30m_avg_hsl) as accuracy,
    last(now_avg_hsl) as precision,
    last(next30m_avg_hsl) as recall,
    last(last30m_worst_hsl) as f1,
    last(now_worst_hsl) as count,
    first("predicted(next30m_avg_hsl)") as next30m_avg_hsl,
    first("predicted(next30m_worst_hsl)") as next30m_worst_hsl
  | eval next30m_worst_hsl=if(next30m_worst_hsl<next30m_avg_hsl, next30m_avg_hsl, next30m_worst_hsl)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [health_score_prediction_output]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = appendpipe
  [| fields next30m_avg_hs, next30m_worst_hs, "predicted(next30m_avg_hs)", "predicted(next30m_worst_hs)"
    | appendpipe [fields next30m_worst_hs, "predicted(next30m_worst_hs)"
    | rename next30m_worst_hs as next30m_avg_hs, "predicted(next30m_worst_hs)" as "predicted(next30m_avg_hs)"]
    | eval "predicted(next30m_avg_hs)"=case('predicted(next30m_avg_hs)'>100,100,'predicted(next30m_avg_hs)'<0,0,true(),'predicted(next30m_avg_hs)')
    | `regressionstatistics("next30m_avg_hs", "predicted(next30m_avg_hs)")`
    | rename rSquared as next30m_avg_hs, RMSE as next30m_worst_hs]
  | stats last(next30m_avg_hs) as rSquared,
    last(next30m_worst_hs) as RMSE,
    first("predicted(next30m_avg_hs)") as next30m_avg_hs,
    first("predicted(next30m_worst_hs)") as next30m_worst_hs
  | eval next30m_avg_hs=case(next30m_avg_hs < 0,0,next30m_avg_hs>100,100,true(),round(next30m_avg_hs,2)),
    next30m_worst_hs=case(next30m_worst_hs < 0,0,next30m_worst_hs>next30m_avg_hs,next30m_avg_hs,true(),round(next30m_worst_hs,2))
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [histogram(2)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = var, bins
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = bin "$var$" bins=$bins$ | stats count by "$var$" | makecontinuous "$var$" | fillnull count
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [histperc(3)]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    args = perc, hist_rate, le
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = sort $le$
| eventstats max($hist_rate$) as total_hist_rate, last($le$) as uppermost_bound, count as num_buckets
| eval rank=exact($perc$)*total_hist_rate
| streamstats current=f last($le$) as gr, last($hist_rate$) as last_hist_rate
| eval gr=if(isnull(gr), 0, gr), last_hist_rate=if(isnull(last_hist_rate), 0, last_hist_rate)
| where $hist_rate$ >= rank
| head 1
| eval res=case(lower(uppermost_bound) != "+inf" or num_buckets < 2, "NaN", lower($le$) == "+inf", gr, gr == 0 and $le$ <= 0, $le$, true(), exact(gr + ($le$-gr)*(rank - last_hist_rate) / ($hist_rate$ - last_hist_rate)))
| fields res
| rename res as "histperc"
/data/splunk/splunk/etc/apps/search/default/macros.conf                    errormsg = 1st arg "perc" must be a number between 0 and 1 (inclusive), 2nd arg "hist_rate" should be string representing a field name, and 3rd arg "le" must be the field name with the histogram buckets' upper boundaries.
/data/splunk/splunk/etc/apps/search/default/macros.conf                    iseval = 0
/data/splunk/splunk/etc/apps/search/default/macros.conf                    validation = isnum($perc$) and $perc$ >= 0 and $perc$ <= 1 and isstr($hist_rate$) and isstr($le$)
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [histperc(4)]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    args = perc, hist_rate, le, groupby
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = sort $groupby$, $le$
| eventstats max($hist_rate$) as total_hist_rate, last($le$) as uppermost_bound, count as num_buckets by $groupby$
| eval rank=exact($perc$)*total_hist_rate
| streamstats current=f last($le$) as gr, last($hist_rate$) as last_hist_rate by $groupby$
| eval gr=if(isnull(gr), 0, gr), last_hist_rate=if(isnull(last_hist_rate), 0, last_hist_rate)
| where $hist_rate$ >= rank
| dedup $groupby$
| eval res=case(lower(uppermost_bound) != "+inf" or num_buckets < 2, "NaN", lower($le$) == "+inf", gr, gr == 0 and $le$ <= 0, $le$, true(), exact(gr + ($le$-gr)*(rank - last_hist_rate) / ($hist_rate$ - last_hist_rate)))
| fields $groupby$, res
| rename res as "histperc"
/data/splunk/splunk/etc/apps/search/default/macros.conf                    errormsg = 1st arg "perc" must be a number between 0 and 1 (inclusive), 2nd arg "hist_rate" should be string representing a field name, and 3rd arg "le" must be the field name with the histogram buckets' upper boundaries. 4th arg "groupby" must be a string with one or more field names, and must be quoted if there are multiple fields.
/data/splunk/splunk/etc/apps/search/default/macros.conf                    iseval = 0
/data/splunk/splunk/etc/apps/search/default/macros.conf                    validation = isnum($perc$) and $perc$ >= 0 and $perc$ <= 1 and isstr($hist_rate$) and isstr($le$) and isstr($groupby$)
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    [instrumentation_distribution_strings(3)]
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    args = name,multiplier,round_digits
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    definition = "\"avg\":"+`instrumentation_number_format($name$_avg,$multiplier$,$round_digits$)` + "," + "\"min\":"+`instrumentation_number_format($name$_min,$multiplier$,$round_digits$)` + "," + "\"max\":"+`instrumentation_number_format($name$_max,$multiplier$,$round_digits$)` + "," + "\"p10\":"+`instrumentation_number_format($name$_p10,$multiplier$,$round_digits$)` + "," + "\"p20\":"+`instrumentation_number_format($name$_p20,$multiplier$,$round_digits$)` + "," + "\"p30\":"+`instrumentation_number_format($name$_p30,$multiplier$,$round_digits$)` + "," + "\"p40\":"+`instrumentation_number_format($name$_p40,$multiplier$,$round_digits$)` + "," + "\"p50\":"+`instrumentation_number_format($name$_p50,$multiplier$,$round_digits$)` + "," + "\"p60\":"+`instrumentation_number_format($name$_p60,$multiplier$,$round_digits$)` + "," + "\"p70\":"+`instrumentation_number_format($name$_p70,$multiplier$,$round_digits$)` + "," + "\"p80\":"+`instrumentation_number_format($name$_p80,$multiplier$,$round_digits$)` + "," + "\"p90\":"+`instrumentation_number_format($name$_p90,$multiplier$,$round_digits$)`
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    [instrumentation_distribution_values(1)]
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    args = name
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    definition = avg($name$) as $name$_avg min($name$) as $name$_min max($name$) as $name$_max perc10($name$) as $name$_p10 perc20($name$) as $name$_p20 perc30($name$) as $name$_p30 perc40($name$) as $name$_p40 perc50($name$) as $name$_p50 perc60($name$) as $name$_p60 perc70($name$) as $name$_p70 perc80($name$) as $name$_p80 perc90($name$) as $name$_p90
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    [instrumentation_number_format(3)]
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    args = name,multiplier,round_digits
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    definition = tostring(coalesce(round($name$*$multiplier$,$round_digits$), "null"))
/data/splunk/splunk/etc/apps/splunk_instrumentation/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [is_invalid_ratio(2)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = occurrence, total_occurrences
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = isnull($occurrence$) OR isnull($total_occurrences$)
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [is_null_or_empty_string(1)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = field
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = isnull($field$) OR (trim(tostring($field$)," ")=="")
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              iseval = 0
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [is_object_in_maintenance(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = object_type, object_key_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval maintenance_object_type = "$object_type$", maintenance_object_key = $object_key_field$ | lookup operative_maintenance_log maintenance_object_type, maintenance_object_key OUTPUT _key as maintenance_log_key | eval in_maintenance = if(IsNull(maintenance_log_key), 0, 1) | fields - maintenance_object_key, maintenance_object_type, maintenance_log_key
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_check_model_count(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,suffix
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_kpi_urgency($sid$)`| search urgency=* | eval s=replace(kpiid, "-", "_")
  | append [| makeresults | eval s="hs_$suffix$"] | append [| makeresults | eval s="ss_$suffix$"]
  | appendpipe [search [| listmodels |  search name="itsi_predict_kpi_*" | rex field=name "itsi_predict_kpi_(?<s>.*)"
    | fields s] | stats count as modelcount]
  | appendpipe [stats count(kpiid) as kpicount]
  | stats last(kpicount) as kpicount, last(modelcount) as modelcount
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_confusionmatrix(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = a, p
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = rename "$a$" as actual, "$p$" as predicted
  | stats count by actual predicted
  | appendpipe [ | makeresults count=9 
    | streamstats count as n 
    | head 9 
    | eval actual=case(n/3<=1, "Normal", n/3<=2, "Medium", true(), "Critical"),
      predicted=case(n%3=0, "Normal", n%3=1, "Medium", true(), "Critical"), count=0 
    | fields - _time n]
  | stats sum(count) as count by actual predicted
  | xyseries actual predicted count
  | rename * as "Predicted *"
  | fillnull value=0
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_comment_index]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=itsi_grouped_alerts `itsi_event_management_comment_sourcetype`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_comment_sourcetype]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = sourcetype=itsi_notable:comment
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_group_index]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=itsi_grouped_alerts `itsi_event_management_group_sourcetype` NOT source=itsi@internal@group_closing_event NOT itsi_dummy_closing_flag=*
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_group_index_with_close_events]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=itsi_grouped_alerts `itsi_event_management_group_sourcetype`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_group_index_with_state(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = event_filter
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_event_management_group_index` $event_filter$ | `itsi_notable_group_lookup`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_group_sourcetype]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = sourcetype=itsi_notable:group
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_index]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=itsi_tracked_alerts `itsi_event_management_sourcetype` NOT source=itsi@internal@group_closing_event
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_index_with_close_events]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=itsi_tracked_alerts `itsi_event_management_sourcetype`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_index_with_close_events_filter_count]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = count(eval(if(index=="itsi_tracked_alerts", "true", null)))
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_index_with_state(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = event_filter
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_event_management_index` $event_filter$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_noise_reduction]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_event_management_group_index` | eval idf=event_id."|".itsi_policy_id | stats dc(idf) as num_events dc(itsi_group_id) as num_groups | eval noisereduction=((num_events-num_groups)/num_events)*100 | fields - num_groups num_events
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_snow_incidents]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = sourcetype=snow:incident
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_sourcetype]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = sourcetype=itsi_notable:event
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_event_management_tickets_lookup]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = lookup itsi_notable_event_external_ticket event_id OUTPUT tickets.ticket_system AS ticket_system, tickets.ticket_id AS ticket_id, tickets.ticket_url AS ticket_url  | eval all_tickets=mvzip(ticket_system, ticket_id, " - ") | lookup itsi_notable_event_external_ticket event_id AS itsi_group_id OUTPUT tickets.ticket_system AS ticket_system_snow, tickets.ticket_id AS ticket_id_snow, tickets.ticket_url AS ticket_url_snow  | eval all_tickets=if(isnull(all_tickets), mvzip(ticket_system_snow, ticket_id_snow, " - "), mvappend(all_tickets, mvzip(ticket_system_snow, ticket_id_snow, " - "))) | fields - ticket_system,ticket_id, ticket_url, ticket_system_snow, ticket_id_snow, ticket_url_snow
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_events_compare_teams(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = itsi_team_id_list
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = search (service_ids=*null*) OR (NOT service_ids=*) OR [|inputlookup itsi_services_in_team_lookup where $itsi_team_id_list$ | rename _key as service_ids  | eval service_ids="*".service_ids."*" | fields service_ids]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_extract_notable_event_required_fields]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = spath severity | spath status | spath owner | spath title | spath description | spath event_id
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_get_affecting_entities(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = kpi_id_summary_list
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` $kpi_id_summary_list$ indexed_is_service_aggregate::0 | stats avg(alert_level) AS alert_level by entity_title, entity_key, itsi_service_id, itsi_kpi_id, kpi | sort 0 -alert_level | head 5
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_get_event_id]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_map_notable_fields` | `gettime` | `itsi_get_sid_id` | eval event_id= orig_sid."@@notable@@".orig_rid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_get_sid_id]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = addinfo | fields - info_*_time | streamstats count as rid | eval rid=rid-1 | rename info_sid as orig_sid,rid as orig_rid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_groups_compare_teams(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = itsi_team_id_list
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = search (itsi_service_ids=*null*) OR (NOT itsi_service_ids=*) OR [|inputlookup itsi_services_in_team_lookup where $itsi_team_id_list$ | rename _key as itsi_service_ids  | eval itsi_service_ids="*".itsi_service_ids."*" | fields itsi_service_ids]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_map_notable_fields]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = rename _time as orig_time | rename _raw as orig_raw | eval orig_raw=sha256(orig_raw) | `itsi_rename_if_tgt_null(event_id, "orig", "_")` | `itsi_rename_if_tgt_null(tag, "orig", "_")` | rename splunk_server as orig_splunk_server, linecount as orig_linecount, eventtype as orig_eventtype, timestartpos as orig_timestartpos, timeendpos as orig_timeendpos, status as orig_status, owner as orig_owner, owner as orig_owner, tag::* as orig_tag::* | fields - date_*, punct
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_match_entities(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field, sec_grp_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval itsi_identifier_lookup="$entity_field$=" + $entity_field$ | lookup itsi_entities _itsi_identifier_lookups as itsi_identifier_lookup OUTPUT _key as entity_key, title as entity_title, services._key as serviceid, sec_grp as $sec_grp_field$ | fields - itsi_identifier_lookup
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_notable_archive_index]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=itsi_notable_archive
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_notable_audit_index]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = index=itsi_notable_audit
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_notable_event_actions_coalesce_state_values]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval status=coalesce(status, action_temp_status) | eval owner=coalesce(owner, action_temp_owner) | eval severity=coalesce(severity,action_temp_severity) | eval title=coalesce(title, action_temp_title) | eval description=coalesce(description, action_temp_description) | fields - action_temp_*
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_notable_event_actions_temp_state_values]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval action_temp_status=status | eval action_temp_owner=owner | eval action_temp_severity=severity | eval action_temp_title=title | eval action_temp_description=description
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_notable_group_lookup]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = lookup itsi_notable_group_user_lookup _key AS itsi_group_id OUTPUT owner severity status | lookup itsi_notable_group_system_lookup _key AS itsi_group_id OUTPUT title description start_time last_time is_active event_count
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_notable_group_user_lookup_filter(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = filter
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = [ inputlookup itsi_notable_group_user_lookup WHERE $filter$ | fields _key | rename _key AS itsi_group_id ]
/data/splunk/splunk/etc/apps/DA-ITSI-OS/default/macros.conf                [itsi_os_module_indexes]
/data/splunk/splunk/etc/apps/DA-ITSI-OS/default/macros.conf                definition = (index=windows OR index=perfmon OR index=os)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_predict(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,outputtype,modelname
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `apply_model($sid$,$modelname$)` | `$outputtype$_prediction_output`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_predict_one_number(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,type,modelname
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_predictive_analytics_dataset($sid$)` | apply $modelname$_ss | apply $modelname$_worst as $type$
  | fields $type$ | search $type$=* | head 1 | eval $type$=if($type$<0,0,$type$) | eval $type$=if($type$>100,100,$type$)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_predictive_analytics_dataset(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_summary_with_dependence($sid$)`
  | timechart limit=0 span=5m avg(alert_value) as value_avg
    min(alert_value) as value_min
    max(alert_value) as value_max
    stdev(alert_value) as value_std
    avg(alert_level) as level_avg
    max(alert_level) as level_max
    avg(eval(if(is_service_max_severity_event=1, alert_value, null))) as value_ms_avg
    min(eval(if(is_service_max_severity_event=1, alert_value, null))) as value_ms_min
    max(eval(if(is_service_max_severity_event=1, alert_value, null))) as value_ms_max by kpiid
  | rename "value_avg: SHKPI-$sid$" as now_avg_hs,
    "value_min: SHKPI-$sid$" as now_worst_hs,
    "level_avg: SHKPI-$sid$" as now_avg_hsl,
    "level_max: SHKPI-$sid$" as now_worst_hsl
  | search now_avg_hs=*
  | eval now_avg_hsl=case(now_avg_hsl>=5, "Critical", now_avg_hsl>=3, "Medium", true(), "Normal"),
    now_worst_hsl=case(now_worst_hsl>=5, "Critical", now_worst_hsl>=3, "Medium", true(), "Normal")
  | eval this_date_day = strftime(_time, "%w")."_",
    this_date_hour = strftime(_time, "%H")."_"
  | filldown
  | streamstats window=6 current=f first("value_avg: *") as last30mkpi_*,
    first("now_avg_hs") as last30m_avg_hs,
    first("now_worst_hs") as last30m_worst_hs,
    first("now_avg_hsl") as last30m_avg_hsl,
    first("now_worst_hsl") as last30m_worst_hsl
  | reverse
  | streamstats window=6 current=f first("value_avg: *") as next30mkpi_*,
    first("now_avg_hs") as next30m_avg_hs,
    first("now_worst_hs") as next30m_worst_hs,
    first("now_avg_hsl") as next30m_avg_hsl,
    first("now_worst_hsl") as next30m_worst_hsl
  | where _time < now() - 300
  | foreach next30m* [eval <<FIELD>>=if(_time<now()-2100,'<<FIELD>>',Null)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_rename_if_tgt_null(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = field, prefix, sep
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval "$prefix$$sep$$field$"=if(isnull('$prefix$$sep$$field$'), '$field$', '$prefix$$sep$$field$') | fields - "$field$"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [itsi_summary_with_dependence(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` indexed_itsi_service_id::$sid$ OR [| getservice service=$sid$
  | rex field=services_depends_on "kpis=(?<kpiid>.*)"
  | fields kpiid
  | mvexpand kpiid
  | eval kpiid=if(like(kpiid, "%,%"), split(kpiid, ","), kpiid) | mvexpand kpiid]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [kpi_correlation_meta_data(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = timeLabel
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval kpi=coalesce(kpi, "ServiceHealthScore") | `getPercentage(alert_period, occurrences)` | eval service_kpi_ids= itsi_service_id + ":" + itsi_kpi_id | eval statement=kpi." had severity value ".severity." ".occurrences." times in "."$timeLabel$" | stats list(statement) as all_info dc(service_kpi_ids) as total_kpis values(*) as * |  eval event_description=mvjoin(all_info, ". ") | eval _raw=event_description
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [kpi_values_over_time(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_summary_with_dependence($sid$)`
  | timechart limit=0 span=5m avg(alert_value) BY kpiid
  | untable _time, kpiid, value
  | join kpiid [| inputlookup service_kpi_lookup
  | eval zipped=mvzip('kpis._key', 'kpis.title')
  | mvexpand zipped |eval temp=split(zipped,",")
  | eval kpiid=mvindex(temp,0), kpititle=mvindex(temp,1)
  | eval kpiname= title.": ".kpititle
  | fields kpiid, kpiname]
  | xyseries _time kpiname value
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [listmodels_by_type(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = modelname
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = listmodels | search name="$modelname$_*"
  | rex field=name "(?<name>.*)_(?<usage>[a-z]*)$"
  | stats count by name, usage
  | xyseries name, usage, count
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [lookup_kpi_entity_filter_rule(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = kpi_id
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = | inputlookup itsi_entity_filter_rules_lookup where kpi_id="$kpi_id$" | `entity_filter_rule_mvevals`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [lookup_shared_base_search_entity_filter_rule(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = search_id
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = | inputlookup itsi_entity_filter_rules_lookup where base_search_id="$search_id$" | `entity_filter_rule_mvevals`
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_alerts_base]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = ()
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_audit_logs]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_logs` OR `macro_kubernetes_host_logs`) "audit.k8s.io"
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_base]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = ()
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_events]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=kubernetes_events)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_host_logs]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=kubernetes_host_logs)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_host_logs_kubelet]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_host_logs` AND (syslog_component::kubelet* OR source="*/kubelet.log*"))
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_logs]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` (sourcetype=kubernetes_logs OR source=/kubernetes/logs/*))
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_logs_collectord]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_logs` source=/kubernetes/*/collectorforkubernetes:*)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_logs_collectord_license_check]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_logs_collectord` license-check)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_mount_stats]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=kubernetes_mount_stats)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_net_socket_table]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=kubernetes_net_socket_table)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_net_stats]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=kubernetes_net_stats*)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_objects]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=kubernetes_objects)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_proc_capabilities_hex_to_binary(2)]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      args = output, input
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = eval $output$=replace(replace(replace(replace(replace(replace(replace(replace(
                           replace(replace(replace(replace(replace(replace(replace(replace(
                           replace(replace(upper($input$),"0","0000"),"1","0001"),"2","0010")
                           ,"3","0011"),"4","0100"),"5","0101"),"6","0110"),"7","0111"),"8","1000"),
                           "9","1001"),"A","1010"),"B","1011"),"C","1100"),"D","1101"),"E","1110"),"F"
                           ,"1111"), "0", "/0"), "1", "/1")
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      iseval = 0
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_proc_stats]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` (sourcetype=kubernetes_proc_stats OR sourcetype=kubernetes_proc_stats_v2))
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_prometheus_metrics]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=prometheus OR sourcetype=kubernetes_prometheus)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_prometheus_metrics_controller_manager]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_prometheus_metrics` source=controller-manager)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_prometheus_metrics_coredns]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_prometheus_metrics` source=coredns)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_prometheus_metrics_etcd]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_prometheus_metrics` source=etcd)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_prometheus_metrics_kubelet]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_prometheus_metrics` source=kubelet)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_prometheus_metrics_kubernetes_api]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_prometheus_metrics` source=kubernetes-api)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_prometheus_metrics_scheduler]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_prometheus_metrics` source=scheduler)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_stats]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` sourcetype=kubernetes_stats*)
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_stats_cgroup]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` (sourcetype=kubernetes_stats_v2_cgroup OR (sourcetype=kubernetes_stats AND NOT source="/")))
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      [macro_kubernetes_stats_host]
/data/splunk/splunk/etc/apps/monitoringkubernetes/default/macros.conf      definition = (`macro_kubernetes_base` (sourcetype=kubernetes_stats_v2_host OR (sourcetype=kubernetes_stats AND source="/")))
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [match_breakdown_entities(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_breakdown_field, sec_grp_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval itsi_identifier_lookup="$entity_breakdown_field$=" + $entity_breakdown_field$ | lookup itsi_entities _itsi_identifier_lookups as itsi_identifier_lookup OUTPUT title as entity_title, _key as entity_key, sec_grp as entity_sec_grp | `normalize_matched_entities($entity_breakdown_field$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [match_entities(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_match_entities($entity_field$, entity_sec_grp)` | `normalize_matched_entities($entity_field$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [match_entities(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field, sec_grp_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_match_entities($entity_field$, $sec_grp_field$)` | `normalize_matched_entities($entity_field$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [match_entities_to_correlation_search(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field, sec_grp_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_match_entities($entity_field$, $sec_grp_field$)` | `normalize_correlation_search_matched_entities($entity_field$)`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [match_filter_entites(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_filter_field, sec_grp_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval itsi_identifier_lookup="$entity_filter_field$=" + $entity_filter_field$ | lookup itsi_entities _itsi_identifier_lookups as itsi_identifier_lookup OUTPUT services._key as serviceid | fields - itsi_identifier_lookup
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [modvizpredict(6)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = v, a, f, h, p, ci
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = predict "$v$" as prediction algorithm=$a$ future_timespan=$f$ holdback=$h$ $p$ lower$ci$=lower$ci$ upper$ci$=upper$ci$ | eval _ft=$f$, _hb=$h$, _vars="$v$", _ci=$ci$
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [neap_preview_event_limit]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = head 10000
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [no_entities_matched]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = _time!=*
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [no_health_score_data]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` source!=service_health_monitor
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [normalize_correlation_search_matched_entities(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `is_object_in_maintenance("entity", entity_key)` | eval is_entity_defined=if(isnull(entity_key), "0", "1"), entity_key=if(isnull(entity_key), "N/A", entity_key), entity_title=coalesce(entity_title,'$entity_field$'), is_service_aggregate="0", is_entity_in_maintenance = in_maintenance | fields - in_maintenance, entity_sec_grp
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              [normalize_field(1)]
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              args = field
/data/splunk/splunk/etc/apps/DA-ITSI-EUEM/default/macros.conf              definition = if(`is_null_or_empty_string($field$)`, "undefined", tostring($field$))
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [normalize_matched_entities(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = entity_field
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `is_object_in_maintenance("entity", entity_key)` | eval is_entity_defined=if(isnull(entity_key), "0", "1"), entity_key=if(isnull(entity_key), "N/A", entity_key), entity_title=coalesce(entity_title,'$entity_field$'), is_service_aggregate="0", is_entity_in_maintenance = in_maintenance | fields - $entity_field$, in_maintenance, entity_sec_grp
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [only_health_score_level_prediction_output(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,modelname
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `apply_model($sid$,$modelname$)` | fields "predicted(next30m_worst_hsl)" | head 1
  | rename "predicted(next30m_worst_hsl)" AS next30m_worst_hsl
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [only_health_score_prediction_output(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,modelname
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `apply_model($sid$,$modelname$)` | fields "predicted(next30m_worst_hs)" | head 1
  | rename "predicted(next30m_worst_hs)" AS next30m_worst_hs
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [predict_actual_vs_predicted(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,modelname,split
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_predictive_analytics_dataset($sid$)`
  | sample seed=1001 partitions=100 fieldname="pn"
  | where pn>=(100 - $split$)
  | apply $modelname$_ss
  | apply $modelname$_avg as "Predicted Health Score"
  | eval "Predicted Health Score"=case('Predicted Health Score'>100,100,'Predicted Health Score'<0,0,true(),'Predicted Health Score')
  | rename next30m_avg_hs as "Actual Health Score"
  | table "Actual Health Score" "Predicted Health Score"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [predict_residual_error(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,modelname,split
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_predictive_analytics_dataset($sid$)`
  | sample seed=1001 partitions=100 fieldname="pn"
  | where pn>=(100 - $split$)
  | apply $modelname$_ss
  | apply $modelname$_avg as predicted
  | eval predicted = case(predicted>100,100,predicted<0,0,true(),predicted)
  | eval residual = next30m_avg_hs - predicted
  | `histogram(residual, 100)`
  | rename count as "Sample Count", residual as "Residual Error"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [prepare_kpi_trend_data(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,suffix
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = outputcsv itsi_predict_kpi_$suffix$.csv
  | fields - _time, *
  | `get_kpi_urgency($sid$)`
  | eval model_suffix=replace(kpiid, "-", "_")

/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [pretty_print(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = field
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = eval $field$=case(($field$>999999999 OR $field$<-999999999), tostring(round($field$/1000000000, 1))+"B", ($field$>99999 OR $field$<-99999), tostring(round($field$/1000000, 1))+"M", ($field$>999 OR $field$<-999), tostring(round($field$/1000, 1))+"K", true(), $field$)
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [r2_for_kpi_trends(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = suffix
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = inputcsv itsi_predict_kpi_top_n_$suffix$.csv
  | fieldsummary actual_*
  | rex field=field "actual_(?<kpiid>.*)"
  | map search="| inputcsv itsi_predict_kpi_top_n_$suffix$.csv | `regressionstatistics(actual_$kpiid$, predicted_$kpiid$)`"
  | fields rSquared
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [regressionstatistics(2)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = a, p
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = rename "$a$" as _actual, "$p$" as _predicted | eventstats avg(_actual) as _avgActual | eval _actualMinusAvg = _actual - _avgActual, _residual = _actual - _predicted | stats sumsq(_actualMinusAvg) as _sumsqActualMinusAvg, sumsq(_residual) as _sumsqResidual, count(_residual) as _sampleCount | eval _sumsqActualMinusAvg=round(_sumsqActualMinusAvg,6), _sumsqResidual = round(_sumsqResidual, 6) | eval rSquared = if(_sumsqActualMinusAvg == 0, "NaN", round(1 - _sumsqResidual / _sumsqActualMinusAvg, 4)), RMSE = round(sqrt(_sumsqResidual / _sampleCount), 2) | table rSquared RMSE
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [root_cause_analysis(3)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,suffix,ntop
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_predictive_analytics_dataset($sid$)`
  | apply app:itsi_predict_kpi_ss_$suffix$
  | `prepare_kpi_trend_data($sid$,$suffix$)`
  | map search="| inputcsv itsi_predict_kpi_$suffix$.csv | apply app:itsi_predict_kpi_$model_suffix$" maxsearches=100
  | timechart limit=0 span=5m first(*)
  | rename "first(next30mkpi_*)" as "actual_*", "first(predicted(next30mkpi_*))" as "predicted_*"
  | fields _time actual_* predicted_*
  | eval _time = _time + 2100
  | reverse
  | outputcsv itsi_predict_kpi_trends_$suffix$.csv
  | foreach actual_* [eval <<FIELD>>=if(isnull('<<FIELD>>'), 'predicted_<<MATCHSTR>>', '<<FIELD>>')]
  | fields - predicted_*
  | untable _time, kpi, value
  | chart limit=0 values(value) by _time,kpi
  | fit StandardScaler "actual_*" with_mean=true with_std=true
  | tail 6
  | stats max(SS_actual_*) as max_* min(SS_actual_*) as min_* first(SS_actual_*) as now_*
  | transpose
  | rex field=column "(?<type>.*)_(?<kpiid>.*)"
  | fields - column
  | xyseries kpiid type "row 1"
  | appendcols [|summary app:itsi_predict_kpi_hs_$suffix$
    | eval d=if(coefficient<0, -1, 1)
    | rex field=feature "value_avg: (?<kpiid>.*)"
    | search kpiid=*
    | fields kpiid, d]
  | appendcols [| `get_kpi_urgency($sid$)`]
  | eval impact=max((now-min)*d,(now-max)*d) * urgency
  | sort - impact
  | head $ntop$
  | streamstats count as n
  | map search="|inputcsv itsi_predict_kpi_trends_$suffix$.csv |fields *_$kpiid$ |rename *_$kpiid$ as *_$n$_$kpiid$"
  | untable _time, kpi, value
  | chart limit=0 values(value) by _time, kpi
  | reverse
  | outputcsv itsi_predict_kpi_top_n_$suffix$.csv
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf [sai_events_indexes]
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf definition = index!=_* AND index!=infra_alerts
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf description = Selects only non-internal indexes.
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf [sai_metadata_indexes]
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf definition = index=em_meta
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf description = A macro command to specify the index(es) to use for Kubernetes metadata searches in SAI.
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf [sai_metrics_indexes]
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf definition = index = em_metrics OR index = vmware-perf-metrics
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf description = A macro command to specify the index(es) to use for metrics searches in SAI.
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_health_data]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `get_itsi_summary_index` source=service_health_monitor scoretype="service_health"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_health_score_backfill(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = service_id
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = bucket _time span=1m | eval itsi_backfill_bucket_string=_time | stats max(_time) AS maxtime, latest(urgency) AS urgency latest(alert_level) AS alert_level latest(alert_severity) as alert_name latest(health_score) as service_health_score latest(service) AS service latest(is_service_in_maintenance) AS is_service_in_maintenance latest(kpi) AS kpi BY itsi_backfill_bucket_string, kpiid, serviceid | eval _time=maxtime+1*60 | fields - itsi_backfill_bucket_string, maxtime' | gethealth service_id="$service_id$" | eval is_backfilled_event="1"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_health_score_time_series(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = serviceid
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `service_health_data` serviceid="$serviceid$" | timechart avg(health_score) by service
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_kpi_list]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = inputlookup service_kpi_lookup | rename _key as serviceid title as service_name | eval kpi_info = mvzip('kpis._key', 'kpis.title', "==@@==") | fields kpi_info service_name serviceid | mvexpand kpi_info | rex field=kpi_info "(?<kpiid>.+)==@@==(?<kpi_name>.+)" | fields - kpi_info
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_level_kpi_only]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = ((indexed_is_service_aggregate::1 AND indexed_is_service_max_severity_event::0) OR (source=service_health_monitor AND scoretype="service_health"))
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_level_kpi_only(1)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = max_severity_event
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = ((indexed_is_service_max_severity_event::$max_severity_event$) OR (source=service_health_monitor AND scoretype="service_health"))
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_level_max_severity_and_service_health_score]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = (indexed_is_service_max_severity_event::1 OR (source=service_health_monitor AND scoretype="service_health"))
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [service_level_max_severity_event_only]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = (indexed_is_service_max_severity_event::1 OR (source=service_health_monitor AND scoretype="service_health"))
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [set_local_host]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = rest splunk_server=local /services/server/info | return host
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [smartforecastviz(1)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = v1
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _vars="$v1$"
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [smartforecastviz(2)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = v1, v2
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _vars=mvappend("$v1$", "$v2$")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [smartforecastviz(3)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = v1, v2, v3
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _vars=mvappend("$v1$", "$v2$", "$v3$")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [smartforecastviz(4)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = v1, v2, v3, v4
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _vars=mvappend("$v1$", "$v2$", "$v3$", "$v4$")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [smartforecastviz(5)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = v1, v2, v3, v4, v5
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _vars=mvappend("$v1$", "$v2$", "$v3$", "$v4$", "$v5$")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [splitby(1)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = s
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _split_by="$s$"
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [splitby(2)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = s1, s2
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _split_by=mvappend("$s1$", "$s2$")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [splitby(3)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = s1, s2, s3
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _split_by=mvappend("$s1$", "$s2$", "$s3$")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [splitby(4)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = s1, s2, s3, s4
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _split_by=mvappend("$s1$", "$s2$", "$s3$", "$s4$")
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         [splitby(5)]
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         args = s1, s2, s3, s4, s5
/data/splunk/splunk/etc/apps/Splunk_ML_Toolkit/default/macros.conf         definition = eval _split_by=mvappend("$s1$", "$s2$", "$s3$", "$s4$", "$s5$")
/data/splunk/splunk/etc/apps/DA-ITSI-STORAGE/default/macros.conf           [stretch_inventory_earliest_time]
/data/splunk/splunk/etc/apps/DA-ITSI-STORAGE/default/macros.conf           definition = [|gentimes start=-1| addinfo | eval earliest=if(info_min_time=="0.000",info_min_time,info_min_time-7200), latest=if(info_max_time=="+Infinity",now(),info_max_time) | table earliest,latest| format "" "" "" "" "" ""]
/data/splunk/splunk/etc/apps/DA-ITSI-STORAGE/default/macros.conf           description = Extended earliest time by -2h of Inventory subsearch for saved searches which uses join between performance and inventory events.
 EMC TA ensures availability of all inventory events from in the best case within 2h.
 So if in Storage Module dashboard user searches for a narrow time range less than 2hrs,
 the join queries may not provide results if Inventory events are not available during that Time Range.
 So we use this macro inside the Inventory sub searches of the join queries which will cause the Performance query to be searched on user selected time range but will join with
 extended earliest time by -2hrs Inventory events.
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    [telegraf_kafka_index]
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    definition = index="telegraf_kafka"
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    [telegraf_kafka_monitoring_kpi_constraints]
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    definition = metric_name="kafka_topics.MessagesInPerSec.OneMinuteRate"
OR metric_name="kafka_topics.BytesInPerSec.OneMinuteRate"
OR metric_name="kafka_topics.BytesOutPerSec.OneMinuteRate"
OR metric_name="kafka_replica_manager.IsrShrinksPerSec.OneMinuteRate"
OR metric_name="kafka_replica_manager.LeaderCount.Value"
OR metric_name="kafka_replica_manager.PartitionCount.Value"
OR metric_name="kafka_topic.TotalProduceRequestsPerSec.OneMinuteRate"
OR metric_name="kafka_topic.TotalFetchRequestsPerSec.OneMinuteRate"
OR metric_name="kafka_topic.FailedProduceRequestsPerSec.OneMinuteRate"
OR metric_name="kafka_topic.FailedFetchRequestsPerSec.OneMinuteRate"
OR metric_name="kafka_jvm_garbage_collector.LastGcInfo.duration"
OR metric_name="kafka_replica_manager.UnderReplicatedPartitions.Value"
OR metric_name="kafka_controller.OfflinePartitionsCount.Value"
OR metric_name="kafka_controller.ActiveControllerCount.Value"
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    [telegraf_kafka_schema_registry_kpi_constraints]
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    definition = metric_name="kafka_schema-registry.master-slave-role.master-slave-role",
OR metric_name="kafka_schema-registry.jetty-metrics.connections-active",
OR metric_name="kafka_schema-registry.jetty-metrics.connections-opened-rate",
OR metric_name="kafka_schema-registry.jetty-metrics.connections-closed-rate",
OR metric_name="kafka_schema-registry.jersey-metrics.request-rate",
OR metric_name="kafka_schema-registry.jersey-metrics.request-latency-avg",
OR metric_name="kafka_schema-registry.jersey-metrics.request-error-rate",
OR metric_name="kafka_schema-registry.jersey-metrics.response-rate",
OR metric_name="kafka_schema-registry.jersey-metrics.response-size-avg",
OR metric_name="kafka_schema-registry.jersey-metrics.response-byte-rate"
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    [telegraf_kafka_span]
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    definition = [ | stats count | addinfo
| eval earliest=if(info_min_time == "0.000", info_search_time,info_min_time)
| eval latest=if(info_max_time == "+Infinity", info_search_time,info_max_time)
| eval searchStartTIme=strftime(earliest,"%a %d %B %Y %H:%M")
| eval searchEndTime=strftime(latest,"%a %d %B %Y %H:%M")
| eval Difference = (latest - earliest)
| eval span=case(
info_min_time == "0.000", "2m",
Difference > (3000*24*60*60),"4d",
Difference > (2000*24*60*60),"3d",
Difference > (1000*24*60*60),"2d",
Difference > (500*24*60*60),"1d",
Difference > (333*24*60*60),"12h",
Difference > (166*24*60*60),"8h",
Difference > (83*24*60*60),"4h",
Difference > (41*24*60*60),"2h",
Difference > (916*60*60),"1h",
Difference > (833*60*60),"55m",
Difference > (750*60*60),"50m",
Difference > (666*60*60),"45m",
Difference > (583*60*60),"40m",
Difference > (500*60*60),"35m",
Difference > (416*60*60),"30m",
Difference > (333*60*60),"25m",
Difference > (250*60*60),"20m",
Difference > (166*60*60),"15m",
Difference > (83*60*60),"10m",
Difference > (66*60*60),"5m",
Difference > (50*60*60),"4m",
Difference > (33*60*60),"3m",
Difference > (16*60*60),"2m",
Difference > (8*60*60),"1m",
Difference <= (8*60*60),"1m"
)
| eval spanrestricted=case(
info_min_time == "0.000", 2*60,
Difference > (916*60*60),60*60,
Difference > (833*60*60),55*60,
Difference > (750*60*60),50*60,
Difference > (666*60*60),45*60,
Difference > (583*60*60),40*60,
Difference > (500*60*60),35*60,
Difference > (416*60*60),30*60,
Difference > (333*60*60),25*60,
Difference > (250*60*60),20*60,
Difference > (166*60*60),15*60,
Difference > (83*60*60),10*60,
Difference > (66*60*60),5*60,
Difference > (50*60*60),4*60,
Difference > (33*60*60),180,
Difference > (16*60*60),120,
Difference > (8*60*60),60,
Difference <= (8*60*60),60
)
| eval span=case(spanrestricted < interval, interval, spanrestricted >= interval, span, isnull(interval), span)
| eval span=if(spanrestricted <= 60, "1m", span)
| return span ]
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    [telegraf_kafka_tasks_monitoring_kpi_constraints]
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    definition = metric_name="kafka_connect.error-task.total-errors-logged"
OR metric_name="kafka_connect.error-task.total-retries"
OR metric_name="kafka_connect.error-task.total-records-skipped"
OR metric_name="kafka_connect.error-task.total-record-failures"
OR metric_name="kafka_connect.error-task.total-record-errors"
OR metric_name="kafka_connect.error-task.deadletterqueue-produce-requests"
OR metric_name="kafka_connect.error-task.deadletterqueue-produce-failures"
OR metric_name="kafka_connect.sink-task.partition-count"
OR metric_name="kafka_connect.sink-task.sink-record-read-rate"
OR metric_name="kafka_connect.sink-task.sink-record-send-rate"
OR metric_name="kafka_connect.sink-task.put-batch-avg-time-ms"
OR metric_name="kafka_connect.sink-task.offset-commit-completion-rate"
OR metric_name="kafka_connect.sink-task.offset-commit-skip-rate"
OR metric_name="kafka_connect.source-task.source-record-poll-rate"
OR metric_name="kafka_connect.source-task.poll-batch-avg-time-ms"
OR metric_name="kafka_connect.source-task.source-record-write-rate"
OR metric_name="kafka_connect.source-task.source-record-active-count-avg"
OR metric_name="kafka_connect.connector-task.running-ratio"
OR metric_name="kafka_connect.connector-task.offset-commit-avg-time-ms"
OR metric_name="kafka_connect.connector-task.batch-size-avg"
OR metric_name="kafka_connect.connector-task.status"
/data/splunk/splunk/etc/apps/DA-ITSI-TELEGRAF-KAFKA/default/macros.conf    iseval = 0
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf [time_modifier(1)]
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf args = time_modifier
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf definition = tostring(relative_time(time(), "$time_modifier$"))
/data/splunk/splunk/etc/apps/splunk_monitoring_console/default/macros.conf iseval = 1
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [topology-daily-snapshot-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = index="aws_topology_daily_snapshot"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [topology-history-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = index="aws_topology_history"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [topology-monthly-snapshot-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = index="aws_topology_monthly_snapshot"
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [topology-playback-index]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = index="aws_topology_playback"
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [train_and_test(5)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,outputtype,alg,modelname,split
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_predictive_analytics_dataset($sid$)`
  | appendpipe [`train_$alg$($modelname$,$split$)` | fields - _time *]
  | apply $modelname$_ss | search next30m_avg_hs>=0
  | sample seed=1001 partitions=100 fieldname="pn"
  | search pn>=$split$ | apply $modelname$_avg | apply $modelname$_worst
  | `$outputtype$_prediction_output`
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [train_gradient_boosting_regressor(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = modelname,split
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = search next30m_avg_hs>=0 AND next30m_worst_hs>=0
  | fit StandardScaler "value*" with_mean=true with_std=true into $modelname$_ss
  | sample seed=1001 partitions=100 fieldname="pn"
  | search pn<$split$
  | appendpipe [| fit GradientBoostingRegressor next30m_avg_hs from
    "SS_*" "this_date_*" last30m_avg_hs now_avg_hs into $modelname$_avg | fields - _time,*]
  | fit GradientBoostingRegressor next30m_worst_hs from
    "SS_*" "this_date_*" last30m_worst_hs now_worst_hs into $modelname$_worst
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [train_kpi_trends(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = sid,suffix
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = `itsi_predictive_analytics_dataset($sid$)`
  | appendpipe [fit LinearRegression fit_intercept=true now_avg_hs from
    "value_avg:*" into app:itsi_predict_kpi_hs_$suffix$ | fields - _time *]
  | fit StandardScaler "value_*" with_mean=true with_std=true into app:itsi_predict_kpi_ss_$suffix$
  | `prepare_kpi_trend_data($sid$,$suffix$)`
  | map search="| inputcsv itsi_predict_kpi_$suffix$.csv | fit GradientBoostingRegressor \"next30mkpi_$kpiid$\" from
    \"SS_*\" \"this_date_*\" \"last30mkpi_$kpiid$\" \"value_avg: $kpiid$\" into app:itsi_predict_kpi_$model_suffix$"
    maxsearches=100
  | head 1
  | fields "predicted(*)"
  | rename "predicted(next30mkpi_*)" as *
  | fields - _time
  | foreach * [eval <<FIELD>>=1]
  | untable modelname kpi dummyfield
  | fields - dummyfield
  | eval modelname="itsi_predict_kpi_".replace(kpi, "-", "_")
  | append [| listmodels
    | search name="itsi_predict_kpi_*_$suffix$"
    | rename name as modelname
    | fields modelname]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [train_linear_regression(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = modelname,split
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = search next30m_avg_hs>=0 AND next30m_worst_hs>=0
  | fit StandardScaler "value*" with_mean=true with_std=true into $modelname$_ss
  | sample seed=1001 partitions=100 fieldname="pn"
  | search pn<$split$
  | appendpipe [| fit LinearRegression fit_intercept=true next30m_avg_hs from
    "SS_*" "this_date_*" last30m_avg_hs now_avg_hs into $modelname$_avg | fields - _time,*]
  | fit LinearRegression fit_intercept=true next30m_worst_hs from
    "SS_*" "this_date_*" last30m_worst_hs now_worst_hs into $modelname$_worst
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [train_logistic_regression(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = modelname,split
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = where in(next30m_avg_hsl, "Normal", "Medium", "Critical") AND in(next30m_worst_hsl, "Normal", "Medium", "Critical")
  | fit StandardScaler "value_*" with_mean=true with_std=true into $modelname$_ss
  | sample seed=1001 partitions=100 fieldname="pn"
  | search pn<$split$
  | appendpipe [| fit LogisticRegression fit_intercept=true next30m_avg_hsl from
    "SS_*" "level_*" "this_date_*" last30m_avg_hsl now_avg_hsl into $modelname$_avg | fields - _time,*]
  | fit LogisticRegression fit_intercept=true next30m_worst_hsl from
    "SS_*" "level_*" "this_date_*" last30m_worst_hsl now_worst_hsl into $modelname$_worst
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [train_random_forest_regressor(2)]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = modelname,split
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = search next30m_avg_hs>=0 AND next30m_worst_hs>=0
  | fit StandardScaler "value*" with_mean=true with_std=true into $modelname$_ss
  | sample seed=1001 partitions=100 fieldname="pn"
  | search pn<$split$
  | appendpipe [| fit RandomForestRegressor next30m_avg_hs from
    "SS_*" "this_date_*" last30m_avg_hs now_avg_hs into $modelname$_avg | fields - _time,*]
  | fit RandomForestRegressor next30m_worst_hs from
    "SS_*" "this_date_*" last30m_worst_hs now_worst_hs into $modelname$_worst
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf [transform_all_sai_groups]
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf definition = `transform_sai_groups(*)`
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf description = A macro command to transform filters of all SAI groups to field-value pairs with the matching group title.
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf [transform_sai_groups(1)]
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf args = group_title
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf definition = inputlookup em_groups where title="$group_title$" 
| makemv delim="," filter 
| mvexpand filter 
| rex field=filter "(?<dim>.*)=(?<val>.*)" 
| stats values(val) as vals by title, dim 
| eval {dim}=vals 
| fields - dim, vals, filter 
| stats values(*) as * by title
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf description = A macro command to transform filters of SAI group(s) to field-value pairs with the matching group title.
/data/splunk/splunk/etc/apps/splunk_app_infrastructure/default/macros.conf iseval = 0
/data/splunk/splunk/etc/apps/search/default/macros.conf                    [truncate_search]
/data/splunk/splunk/etc/apps/search/default/macros.conf                    definition = eval search=if(length(search) > 150, substr(search, 0, 150) + "...", search)
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_bayesian(1)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = word
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_bayesian_lookup word as $word$
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_countset(2)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = word, set
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_countset_lookup word as $word$ set as $set$
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_levenshtein(2)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = w1, w2
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_levenshtein_lookup word1 as $w1$ word2 as $w2$
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_meaning(1)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = word
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_meaning_lookup word as $word$
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_parse(2)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = url, list
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = `ut_parse_extended($url$, $list$)`
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_parse_extended(2)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = url, list
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_parse_extended_lookup url as $url$ list as $list$ | spath input=ut_subdomain_parts | fields - ut_subdomain_parts
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_parse_simple(1)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = url
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_parse_simple_lookup url as $url$
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_shannon(1)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = word
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_shannon_lookup word as $word$
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     [ut_suites(2)]
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     args = word, set
/data/splunk/splunk/etc/apps/utbox/default/macros.conf                     definition = lookup ut_suites_lookup word as $word$ set as $set$ | spath input=ut_suites | fields - ut_suites
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            [volume_size(1)]
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            args = field
/data/splunk/splunk/etc/apps/splunk_app_aws/default/macros.conf            definition = eval $field$=case($field$>1024, tostring(round($field$/1024, 1))+" TB", true(), tostring(round($field$, 0))+" GB")
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   [write_latest_results_to_kpi_cache]
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   args = 
/data/splunk/splunk/etc/apps/SA-ITOA/default/macros.conf                   definition = eval cached_alert_value=if((isnull(alert_value) AND isnull(cached_alert_value)), "N/A", coalesce(alert_value, cached_alert_value)) | fields - alert_value | eval kpi_lookup_key=kpi_id."_".entity_title | outputlookup itsi_kpi_alert_value_cache append=true key_field=kpi_lookup_key | fields - kpi_id, kpi_lookup_key, mod_time | rename cached_alert_value AS alert_value
